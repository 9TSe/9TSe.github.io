<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>JSON和程序发布 | 9TSe</title><meta name="author" content="9TSe"><meta name="copyright" content="9TSe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. JSONJSON(JavaScrip Object Notation)是一种轻量级的数据交换格式。它基于 ECMAScript (欧洲计算机协会制定的js规范)的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。 关于上面的描述可以精简为一句话：J">
<meta property="og:type" content="article">
<meta property="og:title" content="JSON和程序发布">
<meta property="og:url" content="http://example.com/2023/10/22/JSON%E5%92%8C%E7%A8%8B%E5%BA%8F%E5%8F%91%E5%B8%83/index.html">
<meta property="og:site_name" content="9TSe">
<meta property="og:description" content="1. JSONJSON(JavaScrip Object Notation)是一种轻量级的数据交换格式。它基于 ECMAScript (欧洲计算机协会制定的js规范)的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。 关于上面的描述可以精简为一句话：J">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/pic/5.png">
<meta property="article:published_time" content="2023-10-22T01:54:42.000Z">
<meta property="article:modified_time" content="2023-10-22T05:53:18.856Z">
<meta property="article:author" content="9TSe">
<meta property="article:tag" content="JSON">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/pic/5.png"><link rel="shortcut icon" href="/pic/12.png"><link rel="canonical" href="http://example.com/2023/10/22/JSON%E5%92%8C%E7%A8%8B%E5%BA%8F%E5%8F%91%E5%B8%83/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JSON和程序发布',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-10-22 13:53:18'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="9TSe" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/pic/avater.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">44</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('/pic/5.png')"><nav id="nav"><span id="blog-info"><a href="/" title="9TSe"><img class="site-icon" src="/pic/9.png"/></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">JSON和程序发布</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-22T01:54:42.000Z" title="发表于 2023-10-22 09:54:42">2023-10-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-22T05:53:18.856Z" title="更新于 2023-10-22 13:53:18">2023-10-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Qt/">Qt</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="JSON和程序发布"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr>
<hr>
<h1 id="1-JSON"><a href="#1-JSON" class="headerlink" title="1. JSON"></a>1. JSON</h1><p>JSON(<code>JavaScrip Object Notation</code>)是一种<code>轻量级的数据交换格式</code>。它基于 ECMAScript (欧洲计算机协会制定的js规范)的一个子集，采用<code>完全独立于编程语言的文本格式来存储和表示数据</code>。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。</p>
<p>关于上面的描述可以精简为一句话：<code>Json是一种数据格式，和语言无关，在什么语言中都可以使用Json。</code>基于这种通用的数据格式，一般处理两方面的任务：</p>
<ol>
<li>组织数据（数据序列化），用于数据的网络传输</li>
<li>组织数据（数据序列化），写磁盘文件实现数据的持久化存储（一般以.json作为文件后缀）<br>Json中主要有两种数据格式：Json数组和Json对象，并且这两种格式可以交叉嵌套使用，下面依次介绍下这两种数据格式：</li>
</ol>
<h2 id="1-1-Json数组"><a href="#1-1-Json数组" class="headerlink" title="1.1 Json数组"></a>1.1 Json数组</h2><p>Json数组使用 [] 表示，[]里边是元素，元素和元素之间使用逗号间隔，<code>最后一个元素后边没有逗号</code>，一个Json数组中支持同时存在多种不同类型的成员，<br>包括：整形、 浮点、 字符串、 布尔类型、 json数组、 json对象、 空值-null。<br>由此可见Json数组比起C&#x2F;C++数组要灵活很多。</p>
<ul>
<li>Json数组中的元素数据类型一致</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 整形</span></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="comment">// 字符串</span></span><br><span class="line">[<span class="string">&quot;luffy&quot;</span>, <span class="string">&quot;sanji&quot;</span>, <span class="string">&quot;zoro&quot;</span>, <span class="string">&quot;nami&quot;</span>, <span class="string">&quot;robin&quot;</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>Json数组中的元素数据类型不一致</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">12</span>, <span class="number">13.34</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="string">&quot;hello,world&quot;</span>, <span class="literal">null</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>Json数组中的数组嵌套使用</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    [<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;dog&quot;</span>, <span class="string">&quot;panda&quot;</span>, <span class="string">&quot;beer&quot;</span>, <span class="string">&quot;rabbit&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;北京&quot;</span>, <span class="string">&quot;上海&quot;</span>, <span class="string">&quot;天津&quot;</span>, <span class="string">&quot;重庆&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;luffy&quot;</span>, <span class="string">&quot;boy&quot;</span>, <span class="number">19</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>Json数组和对象嵌套使用</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;luffy&quot;</span>:&#123;</span><br><span class="line">            <span class="string">&quot;age&quot;</span>:<span class="number">19</span>,</span><br><span class="line">            <span class="string">&quot;father&quot;</span>:<span class="string">&quot;Monkey·D·Dragon&quot;</span>,</span><br><span class="line">            <span class="string">&quot;grandpa&quot;</span>:<span class="string">&quot;Monkey D Garp&quot;</span>,</span><br><span class="line">            <span class="string">&quot;brother1&quot;</span>:<span class="string">&quot;Portgas D Ace&quot;</span>,</span><br><span class="line">            <span class="string">&quot;brother2&quot;</span>:<span class="string">&quot;Sabo&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="1-2-Json对象"><a href="#1-2-Json对象" class="headerlink" title="1.2 Json对象"></a>1.2 Json对象</h2><p>Json对象使用 {} 来描述，每个Json对象中可以存储若干个元素，每一个元素对应一个键值对（key：value 结构），元素和元素之间使用逗号间隔，最后一个元素后边没有逗号。对于每个元素中的键值对有以下细节需要注意：</p>
<ol>
<li>键值（key）必须是字符串，位于同一层级的键值不要重复（因为是通过键值取出对应的value值）</li>
<li>value值的类型是可选的，可根据实际需求指定，可用类型包括：整形、 浮点、 字符串、 布尔类型、 json数组、 json对象、 空值-null。</li>
</ol>
<p><strong>使用Json对象描述一个人的信息:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;Name&quot;</span>:<span class="string">&quot;Ace&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Sex&quot;</span>:<span class="string">&quot;man&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Age&quot;</span>:<span class="number">20</span>,</span><br><span class="line">    <span class="string">&quot;Family&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;Father&quot;</span>:<span class="string">&quot;Gol·D·Roger&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Mother&quot;</span>:<span class="string">&quot;Portgas·D·Rouge&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Brother&quot;</span>:[<span class="string">&quot;Sabo&quot;</span>, <span class="string">&quot;Monkey D. Luffy&quot;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;IsAlive&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;Comment&quot;</span>:<span class="string">&quot;yyds&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="1-3-注意事项"><a href="#1-3-注意事项" class="headerlink" title="1.3 注意事项"></a>1.3 注意事项</h2><p>通过上面的介绍可用看到，Json的结构虽然简单，但是进行嵌套之后就可以描述很复杂的事情，在项目开发过程中往往需要我们根据实际需求自己定义Json格式用来存储项目数据。</p>
<p>另外，如果需要将Json数据持久化到磁盘文件中<br>需要注意一个问题：<code>在一个Json文件中只能有一个Json数组或者Json对象的根节点，不允许同时存储多个并列的根节点。</code><br>举例说明：</p>
<p><strong>错误的写法</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;luffy&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>:<span class="number">19</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;user&quot;</span>:<span class="string">&quot;ace&quot;</span>,</span><br><span class="line">    <span class="string">&quot;passwd&quot;</span>:<span class="string">&quot;123456&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>错误原因：<br><code>在一个Json文件中有两个并列的Json根节点（并列包含Json对象和Json对象、Json对象和Json数组、Json数组和Json数组），根节点只能有一个。</code></p>
</blockquote>
<p><strong>正确的写法</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;Name&quot;</span>:<span class="string">&quot;Ace&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Sex&quot;</span>:<span class="string">&quot;man&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Age&quot;</span>:<span class="number">20</span>,</span><br><span class="line">    <span class="string">&quot;Family&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;Father&quot;</span>:<span class="string">&quot;Gol·D·Roger&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Mother&quot;</span>:<span class="string">&quot;Portgas·D·Rouge&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Brother&quot;</span>:[<span class="string">&quot;Sabo&quot;</span>, <span class="string">&quot;Monkey D. Luffy&quot;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;IsAlive&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;Comment&quot;</span>:<span class="string">&quot;yyds&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面的例子中通过Json对象以及Json数组的嵌套描述了一个人的身份信息，并且根节点只有一个就是Json对象，如果还需要使用Json数组或者Json对象描述其他信息，需要将这些信息写入到其他文件中，<code>不要和这个Json对象并列写入到同一个文件里边</code></p>
<hr>
<h1 id="2-Qt中JSON操作"><a href="#2-Qt中JSON操作" class="headerlink" title="2. Qt中JSON操作"></a>2. Qt中JSON操作</h1><p>从<code>Qt 5.0</code>开始提供了对Json的支持，我们可以直接使用Qt提供的Json类进行数据的组织和解析。相关的类常用的主要有四个，具体如下：</p>
<table>
<thead>
<tr>
<th>Json类</th>
<th>介绍</th>
</tr>
</thead>
<tbody><tr>
<td>QJsonDocument</td>
<td>封装了一个完整的JSON文档，并且可以从UTF-8编码的基于文本的表示以及Qt自己的二进制格式读取和写入该文档。</td>
</tr>
<tr>
<td>QJsonArray</td>
<td>JSON数组是一个值列表。可以通过从数组中插入和删除QJsonValue来操作该列表。</td>
</tr>
<tr>
<td>QJsonObject</td>
<td>JSON对象是键值对的列表，其中键是唯一的字符串，值由QJsonValue表示。</td>
</tr>
<tr>
<td>QJsonValue</td>
<td>该类封装了JSON支持的数据类型。</td>
</tr>
</tbody></table>
<h2 id="2-1-QJsonValue"><a href="#2-1-QJsonValue" class="headerlink" title="2.1 QJsonValue"></a>2.1 QJsonValue</h2><p>在Qt中<code>QJsonValue</code>可以封装的基础数据类型有六种（和Json支持的类型一致），分别为：</p>
<ul>
<li>布尔类型：<code>QJsonValue::Bool</code></li>
<li>浮点类型（包括整形）： <code>QJsonValue::Double</code></li>
<li>字符串类型： <code>QJsonValue::String</code></li>
<li>Json数组类型： <code>QJsonValue::Array</code></li>
<li>Json对象类型：<code>QJsonValue::Object</code></li>
<li>空值类型： <code>QJsonValue::Null</code></li>
</ul>
<p>这个类型可以通过<code>QJsonValue</code>的构造函数被封装为一个类对象:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Json对象</span></span><br><span class="line"><span class="built_in">QJsonValue</span>(<span class="type">const</span> QJsonObject &amp;o);</span><br><span class="line"><span class="comment">// Json数组</span></span><br><span class="line"><span class="built_in">QJsonValue</span>(<span class="type">const</span> QJsonArray &amp;a);</span><br><span class="line"><span class="comment">// 字符串</span></span><br><span class="line"><span class="built_in">QJsonValue</span>(<span class="type">const</span> <span class="type">char</span> *s);</span><br><span class="line"><span class="built_in">QJsonValue</span>(QLatin1String s);</span><br><span class="line"><span class="built_in">QJsonValue</span>(<span class="type">const</span> QString &amp;s);</span><br><span class="line"><span class="comment">// 整形 and 浮点型</span></span><br><span class="line"><span class="built_in">QJsonValue</span>(qint64 v);</span><br><span class="line"><span class="built_in">QJsonValue</span>(<span class="type">int</span> v);</span><br><span class="line"><span class="built_in">QJsonValue</span>(<span class="type">double</span> v);</span><br><span class="line"><span class="comment">// 布尔类型</span></span><br><span class="line"><span class="built_in">QJsonValue</span>(<span class="type">bool</span> b);</span><br><span class="line"><span class="comment">// 空值类型</span></span><br><span class="line"><span class="built_in">QJsonValue</span>(QJsonValue::Type type = Null);</span><br></pre></td></tr></table></figure>

<p>如果我们得到一个<code>QJsonValue</code>对象，如何判断内部封装的到底是什么类型的数据呢？这时候就需要调用相关的判断函数了，具体如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 是否是Json数组</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isArray</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 是否是Json对象</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isObject</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 是否是布尔类型</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isBool</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 是否是浮点类型(整形也是通过该函数判断)</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isDouble</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 是否是空值类型</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isNull</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 是否是字符串类型</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isString</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 是否是未定义类型(无法识别的类型)</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isUndefined</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>通过判断函数得到对象内部数据的实际类型之后，如果有需求就可以再次将其转换为对应的基础数据类型，对应的API函数如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 转换为Json数组</span></span><br><span class="line"><span class="function">QJsonArray <span class="title">toArray</span><span class="params">(<span class="type">const</span> QJsonArray &amp;defaultValue)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">QJsonArray <span class="title">toArray</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 转换为布尔类型</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">toBool</span><span class="params">(<span class="type">bool</span> defaultValue = <span class="literal">false</span>)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 转换为浮点类型</span></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">toDouble</span><span class="params">(<span class="type">double</span> defaultValue = <span class="number">0</span>)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 转换为整形</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">toInt</span><span class="params">(<span class="type">int</span> defaultValue = <span class="number">0</span>)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 转换为Json对象</span></span><br><span class="line"><span class="function">QJsonObject <span class="title">toObject</span><span class="params">(<span class="type">const</span> QJsonObject &amp;defaultValue)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">QJsonObject <span class="title">toObject</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 转换为字符串类型</span></span><br><span class="line"><span class="function">QString <span class="title">toString</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">QString <span class="title">toString</span><span class="params">(<span class="type">const</span> QString &amp;defaultValue)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-2-QJsonObject"><a href="#2-2-QJsonObject" class="headerlink" title="2.2 QJsonObject"></a>2.2 QJsonObject</h2><p><code>QJsonObject</code>封装了Json中的对象，在里边可以存储多个键值对，为了方便操作，键值为字符串类型，值为<code>QJsonValue</code>类型。关于这个类的使用类似于C++中的STL类，仔细阅读API文档即可熟练上手使用，下面介绍一些常用API函数:</p>
<ul>
<li>如何创建空的Json对象</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QJsonObject::<span class="built_in">QJsonObject</span>();	<span class="comment">// 构造空对象</span></span><br></pre></td></tr></table></figure>

<ul>
<li>将键值对添加到空对象中</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">QJsonObject::insert</span><span class="params">(<span class="type">const</span> QString &amp;key, <span class="type">const</span> QJsonValue &amp;value)</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>获取对象中键值对个数</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">QJsonObject::count</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">QJsonObject::size</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">QJsonObject::length</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>通过key得到value</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QJsonValue <span class="title">QJsonObject::value</span><span class="params">(<span class="type">const</span> QString &amp;key)</span> <span class="type">const</span></span>;    <span class="comment">// utf8</span></span><br><span class="line"><span class="function">QJsonValue <span class="title">QJsonObject::value</span><span class="params">(QLatin1String key)</span> <span class="type">const</span></span>;	    <span class="comment">// 字符串不支持中文</span></span><br><span class="line">QJsonValue QJsonObject::<span class="keyword">operator</span>[](<span class="type">const</span> QString &amp;key) <span class="type">const</span>;</span><br><span class="line">QJsonValue QJsonObject::<span class="keyword">operator</span>[](QLatin1String key) <span class="type">const</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>删除键值对</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonObject::remove</span><span class="params">(<span class="type">const</span> QString &amp;key)</span></span>;</span><br><span class="line"><span class="function">QJsonValue <span class="title">QJsonObject::take</span><span class="params">(<span class="type">const</span> QString &amp;key)</span></span>;	<span class="comment">// 返回key对应的value值</span></span><br></pre></td></tr></table></figure>

<ul>
<li>通过key进行查找</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">QJsonObject::find</span><span class="params">(<span class="type">const</span> QString &amp;key)</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QJsonObject::contains</span><span class="params">(<span class="type">const</span> QString &amp;key)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>遍历，方式有三种：</p>
<ol>
<li><p>使用相关的迭代器函数</p>
</li>
<li><p>使用 [] 的方式遍历, 类似于遍历数组, []中是键值</p>
</li>
<li><p>先得到对象中所有的键值, 在遍历键值列表, 通过key得到value值</p>
</li>
</ol>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QStringList <span class="title">QJsonObject::keys</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="2-3-QJsonArray"><a href="#2-3-QJsonArray" class="headerlink" title="2.3 QJsonArray"></a>2.3 QJsonArray</h2><p><code>QJsonArray</code>封装了Json中的数组，在里边可以存储多个元素，为了方便操作，所有的元素类统一为<code>QJsonValue</code>类型。关于这个类的使用类似于C++中的STL类，仔细阅读API文档即可熟练上手使用，介绍一些常用API函数:</p>
<ul>
<li>创建空的Json数组</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QJsonArray::<span class="built_in">QJsonArray</span>();</span><br></pre></td></tr></table></figure>

<ul>
<li>添加数据</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::append</span><span class="params">(<span class="type">const</span> QJsonValue &amp;value)</span></span>;	<span class="comment">// 在尾部追加</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::insert</span><span class="params">(<span class="type">int</span> i, <span class="type">const</span> QJsonValue &amp;value)</span></span>; <span class="comment">// 插入到 i 的位置之前</span></span><br><span class="line"><span class="function">iterator <span class="title">QJsonArray::insert</span><span class="params">(iterator before, <span class="type">const</span> QJsonValue &amp;value)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::prepend</span><span class="params">(<span class="type">const</span> QJsonValue &amp;value)</span></span>; <span class="comment">// 添加到数组头部</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::push_back</span><span class="params">(<span class="type">const</span> QJsonValue &amp;value)</span></span>; <span class="comment">// 添加到尾部</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::push_front</span><span class="params">(<span class="type">const</span> QJsonValue &amp;value)</span></span>; <span class="comment">// 添加到头部</span></span><br></pre></td></tr></table></figure>

<ul>
<li>计算数组元素的个数</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">QJsonArray::count</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">QJsonArray::size</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>从数组中取出某一个元素的值</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QJsonValue <span class="title">QJsonArray::at</span><span class="params">(<span class="type">int</span> i)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">QJsonValue <span class="title">QJsonArray::first</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 头部元素</span></span><br><span class="line"><span class="function">QJsonValue <span class="title">QJsonArray::last</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 尾部元素</span></span><br><span class="line">QJsonValueRef QJsonArray::<span class="keyword">operator</span>[](<span class="type">int</span> i);</span><br></pre></td></tr></table></figure>

<ul>
<li>删除数组中的某一个元素</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">QJsonArray::erase</span><span class="params">(iterator it)</span></span>;    <span class="comment">// 基于迭代器删除</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::pop_back</span><span class="params">()</span></span>;           <span class="comment">// 删除尾部</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::pop_front</span><span class="params">()</span></span>;          <span class="comment">// 删除头部</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::removeAt</span><span class="params">(<span class="type">int</span> i)</span></span>;      <span class="comment">// 删除i位置的元素</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::removeFirst</span><span class="params">()</span></span>;        <span class="comment">// 删除头部</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QJsonArray::removeLast</span><span class="params">()</span></span>;         <span class="comment">// 删除尾部</span></span><br><span class="line"><span class="function">QJsonValue <span class="title">QJsonArray::takeAt</span><span class="params">(<span class="type">int</span> i)</span></span>;  <span class="comment">// 删除i位置的原始, 并返回删除的元素的值</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>Josn数组的遍历，常用的方式有两种：</p>
<ol>
<li>可以使用迭代器进行遍历（和使用迭代器遍历STL容器一样）</li>
<li>可以使用数组的方式遍历</li>
</ol>
</li>
</ul>
<hr>
<h2 id="2-4-QJsonDocument"><a href="#2-4-QJsonDocument" class="headerlink" title="2.4 QJsonDocument"></a>2.4 QJsonDocument</h2><p>它封装了一个完整的JSON文档，并且可以从UTF-8编码的基于文本的表示以及Qt自己的二进制格式读取和写入该文档。<code>QJsonObject</code> 和 <code>QJsonArray</code>这两个对象中的数据是不能直接转换为字符串类型的，如果要进行数据传输或者数据的持久化，操作的都是字符串类型而不是 <code>QJsonObject</code> 或者 <code>QJsonArray</code>类型，我们需要通过一个Json文档类进行二者之间的转换。</p>
<p>介绍一下这两个转换流程应该如何操作:</p>
<blockquote>
<p><code>QJsonObject</code> 或者 <code>QJsonArray</code> &#x3D;&#x3D;&#x3D;&gt; 字符串</p>
</blockquote>
<ol>
<li><strong>创建QJsonDocument对象</strong></li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QJsonDocument::<span class="built_in">QJsonDocument</span>(<span class="type">const</span> QJsonObject &amp;object);</span><br><span class="line">QJsonDocument::<span class="built_in">QJsonDocument</span>(<span class="type">const</span> QJsonArray &amp;array);</span><br></pre></td></tr></table></figure>

<p>可以看出，通过构造函数就可以将实例化之后的<code>QJsonObject</code> 或者 <code>QJsonArray</code> 转换为<code>QJsonDocument</code>对象了。</p>
<ol start="2">
<li><strong>将文件对象中的数据进行序列化</strong></li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 二进制格式的json字符串</span></span><br><span class="line"><span class="function">QByteArray <span class="title">QJsonDocument::toBinaryData</span><span class="params">()</span> <span class="type">const</span></span>;	 </span><br><span class="line"><span class="comment">// 文本格式</span></span><br><span class="line"><span class="function">QByteArray <span class="title">QJsonDocument::toJson</span><span class="params">(JsonFormat format = Indented)</span> <span class="type">const</span></span>;	</span><br></pre></td></tr></table></figure>

<p>通过调用<code>toxxx()</code>方法就可以得到文本格式或者二进制格式的Json字符串了。</p>
<ol start="3">
<li><strong>使用得到的字符串进行数据传输, 或者磁盘文件持久化</strong></li>
</ol>
<blockquote>
<p>字符串 &#x3D;&#x3D;&#x3D;&gt; <code>QJsonObject</code> 或者 <code>QJsonArray</code></p>
</blockquote>
<p>一般情况下，通过网络通信或者读磁盘文件就会得到一个Json格式的字符串，如果想要得到相关的原始数据就需要对字符串中的数据进行解析，具体解析流程如下：</p>
<ol>
<li>将得到的Json格式字符串通过 <code>QJsonDocument</code> 类的静态函数转换为<code>QJsonDocument</code>类对象</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">static</span>] <span class="function">QJsonDocument <span class="title">QJsonDocument::fromBinaryData</span><span class="params">(<span class="type">const</span> QByteArray &amp;data, DataValidation validation = Validate)</span></span>;</span><br><span class="line"><span class="comment">// 参数文件格式的json字符串</span></span><br><span class="line">[<span class="type">static</span>] <span class="function">QJsonDocument <span class="title">QJsonDocument::fromJson</span><span class="params">(<span class="type">const</span> QByteArray &amp;json, QJsonParseError *error = Q_NULLPTR)</span></span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>将文档对象转换为json数组&#x2F;对象</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 判断文档对象中存储的数据是不是数组</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QJsonDocument::isArray</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 判断文档对象中存储的数据是不是json对象</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QJsonDocument::isObject</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">    </span></span><br><span class="line"><span class="function"><span class="comment">// 文档对象中的数据转换为json对象</span></span></span><br><span class="line"><span class="function">QJsonObject <span class="title">QJsonDocument::object</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// 文档对象中的数据转换为json数组</span></span><br><span class="line"><span class="function">QJsonArray <span class="title">QJsonDocument::array</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>通过调用<code>QJsonArray</code> , <code>QJsonObject</code> 类提供的 API 读出存储在对象中的数据。<br>关于Qt中Json数据对象以及字符串之间的转换的操作流程是固定的，我们在编码过程中只需要按照上述模板处理即可，相关的操作是没有太多的技术含量可言的。</li>
</ol>
<hr>
<h2 id="2-5-举例"><a href="#2-5-举例" class="headerlink" title="2.5 举例"></a>2.5 举例</h2><h3 id="2-5-1-写文件"><a href="#2-5-1-写文件" class="headerlink" title="2.5.1 写文件"></a>2.5.1 写文件</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">writeJson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QJsonObject obj;</span><br><span class="line">    obj.<span class="built_in">insert</span>(<span class="string">&quot;Name&quot;</span>, <span class="string">&quot;Ace&quot;</span>);</span><br><span class="line">    obj.<span class="built_in">insert</span>(<span class="string">&quot;Sex&quot;</span>, <span class="string">&quot;man&quot;</span>);</span><br><span class="line">    obj.<span class="built_in">insert</span>(<span class="string">&quot;Age&quot;</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    QJsonObject subObj;</span><br><span class="line">    subObj.<span class="built_in">insert</span>(<span class="string">&quot;Father&quot;</span>, <span class="string">&quot;Gol·D·Roger&quot;</span>);</span><br><span class="line">    subObj.<span class="built_in">insert</span>(<span class="string">&quot;Mother&quot;</span>, <span class="string">&quot;Portgas·D·Rouge&quot;</span>);</span><br><span class="line">    QJsonArray array;</span><br><span class="line">    array.<span class="built_in">append</span>(<span class="string">&quot;Sabo&quot;</span>);</span><br><span class="line">    array.<span class="built_in">append</span>(<span class="string">&quot;Monkey D. Luffy&quot;</span>);</span><br><span class="line">    subObj.<span class="built_in">insert</span>(<span class="string">&quot;Brother&quot;</span>, array);</span><br><span class="line">    obj.<span class="built_in">insert</span>(<span class="string">&quot;Family&quot;</span>, subObj);</span><br><span class="line">    obj.<span class="built_in">insert</span>(<span class="string">&quot;IsAlive&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">    obj.<span class="built_in">insert</span>(<span class="string">&quot;Comment&quot;</span>, <span class="string">&quot;yyds&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">QJsonDocument <span class="title">doc</span><span class="params">(obj)</span></span>;</span><br><span class="line">    QByteArray json = doc.<span class="built_in">toJson</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;d:\\ace.json&quot;</span>)</span></span>;</span><br><span class="line">    file.<span class="built_in">open</span>(QFile::WriteOnly);</span><br><span class="line">    file.<span class="built_in">write</span>(json);</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="2-5-2-读文件"><a href="#2-5-2-读文件" class="headerlink" title="2.5.2 读文件"></a>2.5.2 读文件</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::readJson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;d:\\ace.json&quot;</span>)</span></span>;</span><br><span class="line">    file.<span class="built_in">open</span>(QFile::ReadOnly);</span><br><span class="line">    QByteArray json = file.<span class="built_in">readAll</span>();</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line">    QJsonDocument doc = QJsonDocument::<span class="built_in">fromJson</span>(json);</span><br><span class="line">    <span class="keyword">if</span>(doc.<span class="built_in">isObject</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        QJsonObject obj = doc.<span class="built_in">object</span>();</span><br><span class="line">        QStringList keys = obj.<span class="built_in">keys</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;keys.<span class="built_in">size</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            QString key = keys.<span class="built_in">at</span>(i);</span><br><span class="line">            QJsonValue value = obj.<span class="built_in">value</span>(key);</span><br><span class="line">            <span class="keyword">if</span>(value.<span class="built_in">isBool</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">qDebug</span>() &lt;&lt; key &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; value.<span class="built_in">toBool</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(value.<span class="built_in">isString</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">qDebug</span>() &lt;&lt; key &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; value.<span class="built_in">toString</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(value.<span class="built_in">isDouble</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">qDebug</span>() &lt;&lt; key &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; value.<span class="built_in">toInt</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(value.<span class="built_in">isObject</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">qDebug</span>()&lt;&lt; key &lt;&lt; <span class="string">&quot;:&quot;</span>;</span><br><span class="line">                <span class="comment">// 直接处理内部键值对, 不再进行类型判断的演示</span></span><br><span class="line">                QJsonObject subObj = value.<span class="built_in">toObject</span>();</span><br><span class="line">                QStringList ls = subObj.<span class="built_in">keys</span>();</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;ls.<span class="built_in">size</span>(); ++i)</span><br><span class="line">                &#123;</span><br><span class="line">                    QJsonValue subVal = subObj.<span class="built_in">value</span>(ls.<span class="built_in">at</span>(i));</span><br><span class="line">                    <span class="keyword">if</span>(subVal.<span class="built_in">isString</span>())</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;   &quot;</span> &lt;&lt; ls.<span class="built_in">at</span>(i) &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; subVal.<span class="built_in">toString</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(subVal.<span class="built_in">isArray</span>())</span><br><span class="line">                    &#123;</span><br><span class="line">                        QJsonArray array = subVal.<span class="built_in">toArray</span>();</span><br><span class="line">                        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;   &quot;</span> &lt;&lt; ls.<span class="built_in">at</span>(i) &lt;&lt; <span class="string">&quot;:&quot;</span>;</span><br><span class="line">                        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;array.<span class="built_in">size</span>(); ++j)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="comment">// 因为知道数组内部全部为字符串, 不再对元素类型进行判断</span></span><br><span class="line">                            <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;       &quot;</span> &lt;&lt; array[j].<span class="built_in">toString</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一般情况下，对于Json字符串的解析函数都是有针对性的，因为需求不同设计的Json格式就会有所不同，所以不要试图写出一个通用的Json解析函数，这样只会使函数变得臃肿而且不易于维护，每个Json格式对应一个相应的解析函数即可。</p>
<p>上面的例子中演示Qt中Json类相关API函数的使用将解析步骤写的复杂了，因为在解析的时候我们是知道Json对象中的所有key值的，可以直接通过key值将对应的value值取出来，因此上面程序中的一些判断和循环其实是可以省去的。</p>
<hr>
<h1 id="3-cjson库的使用"><a href="#3-cjson库的使用" class="headerlink" title="3. cjson库的使用"></a>3. cjson库的使用</h1><p>C语言的Json库 – cJson。cJSON是一个超轻巧，携带方便，单文件，简单的可以作为ANSI-C标准的JSON解析器。</p>
<p>cJSON 是一个开源项目，<a target="_blank" rel="noopener" href="https://github.com/DaveGamble/cJSON">github下载地址</a></p>
<p>cJSON，目前来说，主要的文件有两个，一个<code>cJSON.c</code> 一个<code>cJSON.h</code>。<br>使用的时候，将<code>头文件include进去即可</code>。<br>如果是在Linux操作系统中使用，编译 到时候需要添加数据库libm.so，如下所示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc  *.c  cJSON.c  -lm</span><br></pre></td></tr></table></figure>


<h2 id="3-1-cJSON结构体"><a href="#3-1-cJSON结构体" class="headerlink" title="3.1 cJSON结构体"></a>3.1 cJSON结构体</h2><p>在<code>cJSON.h</code>中定义了一个非常重要的结构体<code>cJSON</code>，<br>想要熟悉使用cJSON库函数可从cJSON结构体入手，cJSON结构体如下所示：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">cJSON</span> &#123;</span>  </span><br><span class="line">     <span class="class"><span class="keyword">struct</span> <span class="title">cJSON</span> *<span class="title">next</span>,*<span class="title">prev</span>;</span>   </span><br><span class="line">     <span class="class"><span class="keyword">struct</span> <span class="title">cJSON</span> *<span class="title">child</span>;</span>   </span><br><span class="line">     <span class="type">int</span> type;   </span><br><span class="line">     <span class="type">char</span> *valuestring;        <span class="comment">// value值是字符串类型</span></span><br><span class="line">     <span class="type">int</span> valueint;  </span><br><span class="line">     <span class="type">double</span> valuedouble;   </span><br><span class="line">     <span class="type">char</span> *<span class="built_in">string</span>;             <span class="comment">// 对象中的key</span></span><br><span class="line">&#125; cJSON; </span><br></pre></td></tr></table></figure>

<p>关于这个结构体做如下几点的说明:</p>
<ol>
<li><p><code>cJOSN</code>结构体是一个双向链表，并且可通过<code>child</code>指针访问下一层。</p>
</li>
<li><p>结构体成员<code>type</code>变量用于描述数据元素的类型（如果是键值对表示<code>value</code>值的类型），数据元素可以是字符串可以是整形，也可以是浮点型。</p>
<ul>
<li>如果是整形值的话可通过<code>valueint</code>将值取出</li>
<li>如果是浮点型的话可通过<code>valuedouble</code>将值取出</li>
<li>如果是字符串类型的话可通过<code>valuestring</code>将值取出</li>
</ul>
</li>
<li><p>结构体成员<code>string</code>表示键值对中键值的名称。</p>
</li>
</ol>
<p><code>cJSON</code>作为<code>Json</code>格式的解析库，其主要功能就是构建和解析<code>Json</code>格式了，比如要发送数据：用途就是发送端将要发送的数据以<code>json</code>形式封装，然后发送，接收端收到此数据后，还是按<code>json</code>形式解析，就得到想要的数据了。</p>
<hr>
<h2 id="3-2-cJson-API"><a href="#3-2-cJson-API" class="headerlink" title="3.2 cJson API"></a>3.2 cJson API</h2><p>Json格式的数据无外乎有两种Json对象和Json数组，创建的Json数据串可能是二者中 的一种，也可能是二者的组合，不管哪一种通过调用相关的API函数都可以轻松的做到这一点。</p>
<h3 id="3-2-1-数据的封装"><a href="#3-2-1-数据的封装" class="headerlink" title="3.2.1 数据的封装"></a>3.2.1 数据的封装</h3><p>在<code>cJSON.h</code>头文件中可以看到一些函数声明，通过调用这些创建函数就可以将<code>Json</code>支持的数据类型封装为<code>cJSON</code>结构体类型：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 空值类型</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateNull</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="comment">// 布尔类型</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateTrue</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateFalse</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateBool</span><span class="params">(<span class="type">int</span> b)</span>;</span><br><span class="line"><span class="comment">// 数值类型</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateNumber</span><span class="params">(<span class="type">double</span> num)</span>;</span><br><span class="line"><span class="comment">// 字符串类型</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateString</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *<span class="built_in">string</span>)</span>;</span><br><span class="line"><span class="comment">// json数组(创建空数组)</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateArray</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="comment">// json对象(创建空对象)</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateObject</span><span class="params">(<span class="type">void</span>)</span>;</span><br></pre></td></tr></table></figure>

<p>另外，cJson库中还给我我们提供了一些更为简便的操作函数，在创建数组的同时还可以进行初始化</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个Json数组, 元素为整形</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateIntArray</span><span class="params">(<span class="type">const</span> <span class="type">int</span> *numbers,<span class="type">int</span> count)</span>;</span><br><span class="line"><span class="comment">// 创建一个Json数组, 元素为浮点</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateFloatArray</span><span class="params">(<span class="type">const</span> <span class="type">float</span> *numbers,<span class="type">int</span> count)</span>;</span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateDoubleArray</span><span class="params">(<span class="type">const</span> <span class="type">double</span> *numbers,<span class="type">int</span> count)</span>;</span><br><span class="line"><span class="comment">// 创建一个Json数组, 元素为字符串类型</span></span><br><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_CreateStringArray</span><span class="params">(<span class="type">const</span> <span class="type">char</span> **strings,<span class="type">int</span> count)</span>;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-2-2-Json对象操作"><a href="#3-2-2-Json对象操作" class="headerlink" title="3.2.2 Json对象操作"></a>3.2.2 Json对象操作</h3><p>当得到一个<code>Json</code>对象之后，就可以往对象中添加键值对了，可以使用<code>cJSON_AddItemToObject()</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">cJSON_AddItemToObject</span><span class="params">(cJSON *object,<span class="type">const</span> <span class="type">char</span> *<span class="built_in">string</span>,cJSON *item)</span>;</span><br></pre></td></tr></table></figure>

<p>在<code>cJSON</code>库中节点的从属关系是通过树来维护的，每一层节点都是通过链表来维护的，这样就能分析出该函数参数的含义：</p>
<ul>
<li>object：要添加的键值对从属于那个节点</li>
<li>string：添加的键值对的键值</li>
<li>item：添加的键值对的value值（需要先将其封装为cJSON类型的结构体）</li>
</ul>
<p>为了让我的操作更加方便，cJson库还给我们提供了一些宏函数，方便我们快速的往Json对象中添加键值对</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> cJSON_AddNullToObject(object,name)      cJSON_AddItemToObject(object, name, cJSON_CreateNull())</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> cJSON_AddTrueToObject(object,name)      cJSON_AddItemToObject(object, name, cJSON_CreateTrue())</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> cJSON_AddFalseToObject(object,name)     cJSON_AddItemToObject(object, name, cJSON_CreateFalse())</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> cJSON_AddBoolToObject(object,name,b)    cJSON_AddItemToObject(object, name, cJSON_CreateBool(b))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> cJSON_AddNumberToObject(object,name,n)  cJSON_AddItemToObject(object, name, cJSON_CreateNumber(n))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> cJSON_AddStringToObject(object,name,s)  cJSON_AddItemToObject(object, name, cJSON_CreateString(s))</span></span><br></pre></td></tr></table></figure>

<p>我们还可以根据<code>Json</code>对象中的键值取出相应的<code>value</code>值，API函数原型如下:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_GetObjectItem</span><span class="params">(cJSON *object,<span class="type">const</span> <span class="type">char</span> *<span class="built_in">string</span>)</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-2-3-Json数组操作"><a href="#3-2-3-Json数组操作" class="headerlink" title="3.2.3 Json数组操作"></a>3.2.3 Json数组操作</h3><ul>
<li>添加数据到Json数组中（原始数据需要先转换为cJSON结构体类型）</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">cJSON_AddItemToArray</span><span class="params">(cJSON *<span class="built_in">array</span>, cJSON *item)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>得到Json数组中元素的个数:</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">int</span> <span class="title function_">cJSON_GetArraySize</span><span class="params">(cJSON *<span class="built_in">array</span>)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>得到Json数组中指定位置的原素，如果返回NULL表示取值失败了。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_GetArrayItem</span><span class="params">(cJSON *<span class="built_in">array</span>,<span class="type">int</span> item)</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-2-4-序列化"><a href="#3-2-4-序列化" class="headerlink" title="3.2.4 序列化"></a>3.2.4 序列化</h3><p>序列化就是将<code>Json</code>格式的数据转换为字符串的过程，<code>cJson</code>库中给我们提供了3个转换函数，具体如下：</p>
<p>第一个参数<code>item</code>表示Json数据块的根节点。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">char</span>  *<span class="title function_">cJSON_Print</span><span class="params">(cJSON *item)</span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span>  *<span class="title function_">cJSON_PrintUnformatted</span><span class="params">(cJSON *item)</span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span> *<span class="title function_">cJSON_PrintBuffered</span><span class="params">(cJSON *item,<span class="type">int</span> prebuffer,<span class="type">int</span> fmt)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>调用<code>cJSON_Print()</code>函数我们可以得到一个带格式的<code>Json</code>字符串（有换行，看起来更直观）</li>
<li>调用<code>cJSON_PrintUnformatted()</code>函数会得到一个没有格式的<code>Json</code>字符串（没有换行，所有的数据都在同一行）。</li>
<li>调用<code>cJSON_PrintBuffered()</code>函数使用缓冲策略将<code>Json</code>实体转换为字符串，参数<code>prebuffer</code>是指定缓冲区的大小，参数<code>fmt==0</code>表示未格式化，<code>fmt==1</code>表示格式化。</li>
</ul>
<p>我们在编码过程中可以根据自己的实际需求调用相关的操作函数得到对应格式的Json字符串。</p>
<hr>
<h3 id="3-2-5-Json字符串的解析"><a href="#3-2-5-Json字符串的解析" class="headerlink" title="3.2.5 Json字符串的解析"></a>3.2.5 Json字符串的解析</h3><p>如果我们得到了一个Json格式的字符串，想要读出里边的数据，就需要对这个字符串进行解析，处理方式就是将字符串转换为<code>cJSON</code>结构体，然后再基于这个结构体读里边的原始数据，转换函数的函数原型如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> cJSON *<span class="title function_">cJSON_Parse</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *value)</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-2-6-内存释放"><a href="#3-2-6-内存释放" class="headerlink" title="3.2.6 内存释放"></a>3.2.6 内存释放</h3><p>当我们将数据封装为<code>cJSON</code>结构类型的节点之后都会得到一块堆内存，当我们释放某个节点的时候可以调用<code>cJson</code>库提供的删除函数<code>cJSON_Delete()</code>，函数原型如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">void</span>   <span class="title function_">cJSON_Delete</span><span class="params">(cJSON *c)</span>;</span><br></pre></td></tr></table></figure>

<p>该函数的参数为要释放的节点的地址，强调：<br><code>在进行内存地址释放的时候，当前节点以及其子节点都会被删除。</code></p>
<hr>
<h2 id="3-3-Json数据的封装"><a href="#3-3-Json数据的封装" class="headerlink" title="3.3 Json数据的封装"></a>3.3 Json数据的封装</h2><h3 id="3-3-1-Json对象操作举例"><a href="#3-3-1-Json对象操作举例" class="headerlink" title="3.3.1 Json对象操作举例"></a>3.3.1 Json对象操作举例</h3><blockquote>
<p>创建一个对象，并向这个对象里添加字符串和整型键值：</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;cJSON.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    cJSON * root;</span><br><span class="line">    cJSON *arry;</span><br><span class="line"></span><br><span class="line">    root=cJSON_CreateObject();                     <span class="comment">// 创建根数据对象</span></span><br><span class="line">    cJSON_AddStringToObject(root,<span class="string">&quot;name&quot;</span>,<span class="string">&quot;luffy&quot;</span>);  <span class="comment">// 添加键值对</span></span><br><span class="line">    cJSON_AddStringToObject(root,<span class="string">&quot;sex&quot;</span>,<span class="string">&quot;man&quot;</span>);     <span class="comment">// 添加键值对</span></span><br><span class="line">    cJSON_AddNumberToObject(root,<span class="string">&quot;age&quot;</span>,<span class="number">19</span>);        <span class="comment">// 添加键值对</span></span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> *out = cJSON_Print(root);   <span class="comment">// 将json形式转换成字符串</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,out);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 释放内存  </span></span><br><span class="line">    cJSON_Delete(root);  </span><br><span class="line">    <span class="built_in">free</span>(out);        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>运行结果</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>:	<span class="string">&quot;luffy&quot;</span>,</span><br><span class="line">	<span class="string">&quot;sex&quot;</span>:	<span class="string">&quot;man&quot;</span>,</span><br><span class="line">	<span class="string">&quot;age&quot;</span>:	<span class="number">19</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>若干说明:</p>
<ol>
<li><code>cJSON_CreateObject</code>函数可创建一个根对象，返回的是一个 <code>cJSON</code>指针，在这个指针用完了以后，需要手动调用 <code>cJSON_Delete(root)</code>进行内存回收。</li>
<li>函数<code>cJSON_Print()</code>内部封装了malloc函数，所以需要使用<code>free()</code>函数释放被<code>out</code>占用的内存空间。</li>
</ol>
<hr>
<h3 id="3-3-2-Json数组操作举例"><a href="#3-3-2-Json数组操作举例" class="headerlink" title="3.3.2 Json数组操作举例"></a>3.3.2 Json数组操作举例</h3><blockquote>
<p>创建一个数组，并向数组添加一个字符串和一个数字</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    cJSON *root;</span><br><span class="line">    root = cJSON_CreateArray();</span><br><span class="line">    cJSON_AddItemToArray(root, cJSON_CreateString(<span class="string">&quot;Hello world&quot;</span>));</span><br><span class="line">    cJSON_AddItemToArray(root, cJSON_CreateNumber(<span class="number">10</span>)); </span><br><span class="line">    <span class="comment">// char *s = cJSON_Print(root);</span></span><br><span class="line">    <span class="type">char</span> *s = cJSON_PrintUnformatted(root);</span><br><span class="line">    <span class="keyword">if</span>(s)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; %s \n&quot;</span>,s);</span><br><span class="line">        <span class="built_in">free</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    cJSON_Delete(root);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>运行结果:</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&quot;Hello world&quot;</span>,<span class="number">10</span>]</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-3-3-Json对象、数组嵌套使用"><a href="#3-3-3-Json对象、数组嵌套使用" class="headerlink" title="3.3.3 Json对象、数组嵌套使用"></a>3.3.3 Json对象、数组嵌套使用</h3><blockquote>
<p>对象里面包括一个数组，数组里面包括对象，对象里面再添加一个字符串和一个数字</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;person&quot;</span>:[&#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&quot;luffy&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>:<span class="number">19</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>示例代码:</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    cJSON *root, *body, *<span class="built_in">list</span>;</span><br><span class="line">    <span class="comment">// josn 对象 root</span></span><br><span class="line">    root = cJSON_CreateObject();</span><br><span class="line">    <span class="comment">// root 添加键值对 person:json数组A</span></span><br><span class="line">    cJSON_AddItemToObject(root,<span class="string">&quot;person&quot;</span>, body = cJSON_CreateArray());</span><br><span class="line">    <span class="comment">// json数组A 添加Json对象B</span></span><br><span class="line">    cJSON_AddItemToArray(body, <span class="built_in">list</span> = cJSON_CreateObject());</span><br><span class="line">    <span class="comment">// 在json对象B中添加键值对: &quot;name&quot;:&quot;luffy&quot;</span></span><br><span class="line">    cJSON_AddStringToObject(<span class="built_in">list</span>,<span class="string">&quot;name&quot;</span>,<span class="string">&quot;luffy&quot;</span>);</span><br><span class="line">    <span class="comment">// 在json对象B中添加键值对: &quot;age&quot;:19</span></span><br><span class="line">    cJSON_AddNumberToObject(<span class="built_in">list</span>,<span class="string">&quot;age&quot;</span>,<span class="number">19</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// char *s = cJSON_Print(root);</span></span><br><span class="line">    <span class="type">char</span> *s = cJSON_PrintUnformatted(root);</span><br><span class="line">    <span class="keyword">if</span>(s)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; %s \n&quot;</span>,s);</span><br><span class="line">        <span class="built_in">free</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(root)</span><br><span class="line">    &#123;</span><br><span class="line">        cJSON_Delete(root); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>运行结果:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;person&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;luffy&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">19</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-4-解析Json字符串"><a href="#3-4-解析Json字符串" class="headerlink" title="3.4 解析Json字符串"></a>3.4 解析Json字符串</h2><h3 id="3-4-1-解析Json对象"><a href="#3-4-1-解析Json对象" class="headerlink" title="3.4.1 解析Json对象"></a>3.4.1 解析Json对象</h3><p>Json字符串的解析流程和数据的封装流程相反，假设我们有这样一个Json字符串（字符串中的双引号需要通过转义字符将其转译为普通字符）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;\<span class="string">&quot;name\&quot;:\&quot;luffy\&quot;,\&quot;sex\&quot;:\&quot;man\&quot;,\&quot;age\&quot;:19&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>示例代码如下：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cJSON.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    cJSON *json, *name, *sex, *age;</span><br><span class="line">    <span class="type">char</span>* out=<span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;luffy\&quot;,\&quot;sex\&quot;:\&quot;man\&quot;,\&quot;age\&quot;:19&#125;&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    json = cJSON_Parse(out); <span class="comment">//解析成json形式</span></span><br><span class="line">    name = cJSON_GetObjectItem(json, <span class="string">&quot;name&quot;</span>);  <span class="comment">//获取键值内容</span></span><br><span class="line">    sex = cJSON_GetObjectItem(json, <span class="string">&quot;sex&quot;</span>);</span><br><span class="line">    age = cJSON_GetObjectItem(json, <span class="string">&quot;age&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;name:%s,sex:%s,age:%d\n&quot;</span>, name-&gt;valuestring, sex-&gt;valuestring, age-&gt;valueint);</span><br><span class="line"> </span><br><span class="line">    cJSON_Delete(json);  <span class="comment">//释放内存 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>输出的结果:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name</span>:luffy,<span class="attr">sex</span>:man,<span class="attr">age</span>:<span class="number">19</span></span><br></pre></td></tr></table></figure>

<p><code>如果是在严格的场所，应该先判定每个 item 的 type，然后再考虑去取值。</code></p>
<hr>
<h3 id="3-4-2-解析嵌套的Json对象"><a href="#3-4-2-解析嵌套的Json对象" class="headerlink" title="3.4.2 解析嵌套的Json对象"></a>3.4.2 解析嵌套的Json对象</h3><blockquote>
<p>解析一个嵌套的Json对象，数据如下：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;\<span class="string">&quot;list\&quot;:&#123;\&quot;name\&quot;:\&quot;luffy\&quot;,\&quot;age\&quot;:19&#125;,\&quot;other\&quot;:&#123;\&quot;name\&quot;:\&quot;ace\&quot;&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *s = <span class="string">&quot;&#123;\&quot;list\&quot;:&#123;\&quot;name\&quot;:\&quot;luffy\&quot;,\&quot;age\&quot;:19&#125;,\&quot;other\&quot;:&#123;\&quot;name\&quot;:\&quot;ace\&quot;&#125;&#125;&quot;</span>;</span><br><span class="line">    cJSON *root = cJSON_Parse(s);</span><br><span class="line">    <span class="keyword">if</span>(!root) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;get root faild !\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cJSON *js_list = cJSON_GetObjectItem(root, <span class="string">&quot;list&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!js_list) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;no list!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;list type is %d\n&quot;</span>,js_list-&gt;type);</span><br><span class="line"></span><br><span class="line">    cJSON *name = cJSON_GetObjectItem(js_list, <span class="string">&quot;name&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!name) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No name !\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;name type is %d\n&quot;</span>,name-&gt;type);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;name is %s\n&quot;</span>,name-&gt;valuestring);</span><br><span class="line"></span><br><span class="line">    cJSON *age = cJSON_GetObjectItem(js_list, <span class="string">&quot;age&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!age) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;no age!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;age type is %d\n&quot;</span>, age-&gt;type);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;age is %d\n&quot;</span>,age-&gt;valueint);</span><br><span class="line"></span><br><span class="line">    cJSON *js_other = cJSON_GetObjectItem(root, <span class="string">&quot;other&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!js_other) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;no list!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;list type is %d\n&quot;</span>,js_other-&gt;type);</span><br><span class="line"></span><br><span class="line">    cJSON *js_name = cJSON_GetObjectItem(js_other, <span class="string">&quot;name&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!js_name) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No name !\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;name type is %d\n&quot;</span>,js_name-&gt;type);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;name is %s\n&quot;</span>,js_name-&gt;valuestring);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(root)</span><br><span class="line">    &#123;</span><br><span class="line">        cJSON_Delete(root);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打印结果:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">list type is <span class="number">6</span></span><br><span class="line">name type is <span class="number">4</span></span><br><span class="line">name is luffy</span><br><span class="line">age type is <span class="number">3</span></span><br><span class="line">age is <span class="number">19</span></span><br><span class="line">list type is <span class="number">6</span></span><br><span class="line">name type is <span class="number">4</span></span><br><span class="line">name is ace</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-4-3-解析Json数组"><a href="#3-4-3-解析Json数组" class="headerlink" title="3.4.3 解析Json数组"></a>3.4.3 解析Json数组</h3><p>如果我们遇到的Json字符串是一个Json数组格式，处理方式和Json对象差不多，比如我们要解析如下字符串：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;\<span class="string">&quot;names\&quot;:[\&quot;luffy\&quot;,\&quot;robin\&quot;]&#125;</span></span><br></pre></td></tr></table></figure>


<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *s = <span class="string">&quot;&#123;\&quot;names\&quot;:[\&quot;luffy\&quot;,\&quot;robin\&quot;]&#125;&quot;</span>;</span><br><span class="line">    cJSON *root = cJSON_Parse(s);</span><br><span class="line">    <span class="keyword">if</span>(!root) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;get root faild !\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cJSON *js_list = cJSON_GetObjectItem(root, <span class="string">&quot;names&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!js_list)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;no list!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> array_size = cJSON_GetArraySize(js_list);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;array size is %d\n&quot;</span>,array_size);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt; array_size; i++) </span><br><span class="line">    &#123;</span><br><span class="line">        cJSON *item = cJSON_GetArrayItem(js_list, i);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;item type is %d\n&quot;</span>,item-&gt;type);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,item-&gt;valuestring);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(root)</span><br><span class="line">    &#123;</span><br><span class="line">        cJSON_Delete(root);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-4-4-解析嵌套的Json对象和数组"><a href="#3-4-4-解析嵌套的Json对象和数组" class="headerlink" title="3.4.4 解析嵌套的Json对象和数组"></a>3.4.4 解析嵌套的Json对象和数组</h3><p>对于Json字符串最复杂的个数莫过于Json对象和Json数组嵌套的形式，通过一个例子演示一下应该如何解析，字符串格式如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;\<span class="string">&quot;list\&quot;:[&#123;\&quot;name\&quot;:\&quot;luffy\&quot;,\&quot;age\&quot;:19&#125;,&#123;\&quot;name\&quot;:\&quot;sabo\&quot;,\&quot;age\&quot;:21&#125;]&#125;</span></span><br></pre></td></tr></table></figure>

<p>在解析的时候，我们只需要按照从属关系，一层层解析即可：</p>
<ol>
<li>根节点是一个Json对象，基于根节点中的key值取出对应的value值，得到一个Json数组</li>
<li>读出Json数组的大小，遍历里边的各个元素，每个元素都是一个Json对象</li>
<li>将Json对象中的键值对根据key值取出对应的value值</li>
<li>从取出的Value值中读出实际类型对应的数值</li>
</ol>
<p><strong>示例代码如下：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cJSON.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *s = <span class="string">&quot;&#123;\&quot;list\&quot;:[&#123;\&quot;name\&quot;:\&quot;luffy\&quot;,\&quot;age\&quot;:19&#125;,&#123;\&quot;name\&quot;:\&quot;sabo\&quot;,\&quot;age\&quot;:21&#125;]&#125;&quot;</span>;</span><br><span class="line">    cJSON *root = cJSON_Parse(s);</span><br><span class="line">    <span class="keyword">if</span>(!root) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;get root faild !\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cJSON *<span class="built_in">list</span> = cJSON_GetObjectItem(root, <span class="string">&quot;list&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">list</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;no list!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> array_size = cJSON_GetArraySize(<span class="built_in">list</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;array size is %d\n&quot;</span>,array_size);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt; array_size; i++) </span><br><span class="line">    &#123;</span><br><span class="line">        cJSON* item = cJSON_GetArrayItem(<span class="built_in">list</span>, i);</span><br><span class="line">        cJSON* name = cJSON_GetObjectItem(item, <span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;name is %s\n&quot;</span>,name-&gt;valuestring);</span><br><span class="line">        cJSON* age = cJSON_GetObjectItem(item, <span class="string">&quot;age&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;age is %d\n&quot;</span>,age-&gt;valueint);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(root)</span><br><span class="line">    &#123;</span><br><span class="line">        cJSON_Delete(root);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="4-jsoncpp的编译和使用"><a href="#4-jsoncpp的编译和使用" class="headerlink" title="4. jsoncpp的编译和使用"></a>4. jsoncpp的编译和使用</h1><h2 id="4-1-下载和编译"><a href="#4-1-下载和编译" class="headerlink" title="4.1 下载和编译"></a>4.1 下载和编译</h2><h3 id="4-1-1-下载"><a href="#4-1-1-下载" class="headerlink" title="4.1.1 下载"></a>4.1.1 下载</h3><p><strong>下载 jsoncpp</strong><br>Jsoncpp是个跨平台的C++开源库，提供的类为我们提供了很便捷的操作，而且使用的人也很多。在使用之前我们首先要从github仓库下载<a target="_blank" rel="noopener" href="https://github.com/open-source-parsers/jsoncpp">源码</a></p>
<p><strong>下载 cmake 工具</strong><br>由于都是基于VS进行项目开发，下载的源码我们一般不会直接使用，而且将其编译成相应的库文件（动态库或者静态库），这样不论是从使用或者部署的角度来说，操作起来都会更方便一些。</p>
<p>但是，从github下载的源码不能直接通过VS打开，编译就更谈不上了。它提供的默认编译方式是cmake。我们可以通过使用cmake工具将下载的jsoncpp源码生成一个VS项目，这样就可以通过VS编译出需要的库文件了。</p>
<p><a target="_blank" rel="noopener" href="https://cmake.org/download/">官方下载地址</a></p>
<hr>
<h3 id="4-1-2-生成VS项目"><a href="#4-1-2-生成VS项目" class="headerlink" title="4.1.2 生成VS项目"></a>4.1.2 生成VS项目</h3><p>打开CMake</p>
<p><img src="/img/b.1.png" alt="在这里插入图片描述"></p>
<p>需要在工具中指定本地的jsoncpp路径（git clone 之后就会得到这个目录），这是我本地的目录：<br><img src="/img/b.2.png" alt="在这里插入图片描述"></p>
<p>第二个需要指定的是一个文件存储路径（生成的VS项目会保存到这个目录下），保证这是一个本地的有效目录即可。</p>
<p><img src="/img/b.3.png" alt="在这里插入图片描述"></p>
<p>设置好之后进行配置，点击Configure按钮</p>
<p><img src="/img/b.4.png" alt="在这里插入图片描述"></p>
<p>此处需要设置一下，VS的版本以及生成器的平台位数，不填默认就是64位。</p>
<p><img src="/img/b.5.png" alt="在这里插入图片描述"></p>
<p>配置完成，开始生成VS项目。</p>
<p><img src="/img/b.6.png" alt="在这里插入图片描述"></p>
<p>打开在CMake工具中指定的生成目录，我这里是D:\output-project，基于项目文件jsoncpp.sln打开这个VS项目。</p>
<hr>
<h3 id="4-1-3-编译"><a href="#4-1-3-编译" class="headerlink" title="4.1.3 编译"></a>4.1.3 编译</h3><p>基于生成的项目文件打开VS项目之后，可以看到里边有很多子项目</p>
<p><img src="/img/b.7.png" alt="在这里插入图片描述"></p>
<p>我们只需要编译上图标记的那一个就可以了，编译成功之后就可以得到我们需要的库文件了。</p>
<p><img src="/img/b.8.png" alt="在这里插入图片描述"></p>
<p>通过输出的日志信息，就能找到我们想要的动态库了，把这两个文件收集起来备用。</p>
<hr>
<h2 id="4-2-jsoncpp-的使用"><a href="#4-2-jsoncpp-的使用" class="headerlink" title="4.2 jsoncpp 的使用"></a>4.2 jsoncpp 的使用</h2><p><code>jsoncpp</code>库中的类被定义到了一个Json命名空间中，建议在使用这个库的时候先声明这个命名空间：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Json;</span><br></pre></td></tr></table></figure>

<p>使用<code>jsoncpp</code>库解析<code>json</code>格式的数据，我们只需要掌握三个类：</p>
<ol>
<li><code>Value 类</code>：将json支持的数据类型进行了包装，最终得到一个Value类型</li>
<li><code>FastWriter类</code>：将Value对象中的数据序列化为字符串</li>
<li><code>Reader类</code>：反序列化, 将json字符串 解析成 Value 类型</li>
</ol>
<h3 id="4-2-1-Value类"><a href="#4-2-1-Value类" class="headerlink" title="4.2.1 Value类"></a>4.2.1 Value类</h3><p>这个类可以看做是一个包装器，它可以封装Json支持的所有类型，这样我们在处理数据的时候就方便多了。</p>
<table>
<thead>
<tr>
<th>枚举类型</th>
<th>说明</th>
<th>翻译</th>
</tr>
</thead>
<tbody><tr>
<td>nullValue</td>
<td>‘null’ value</td>
<td>不表示任何数据，空值</td>
</tr>
<tr>
<td>intValue</td>
<td>signed integer value</td>
<td>表示有符号整数</td>
</tr>
<tr>
<td>uintValue</td>
<td>unsigned integer value</td>
<td>表示无符号整数</td>
</tr>
<tr>
<td>realValue</td>
<td>double value</td>
<td>表示浮点数</td>
</tr>
<tr>
<td>stringValue</td>
<td>UTF-8 string value</td>
<td>表示utf8格式的字符串</td>
</tr>
<tr>
<td>booleanValue</td>
<td>bool value</td>
<td>表示布尔数</td>
</tr>
<tr>
<td>arrayValue</td>
<td>array value (ordered list)</td>
<td>表示数组，即JSON串中的[]</td>
</tr>
<tr>
<td>objectValue</td>
<td>object value (collection of name&#x2F;value pairs)</td>
<td>表示键值对，即JSON串中的{}</td>
</tr>
</tbody></table>
<p><strong>构造函数</strong><br>Value类为我们提供了很多构造函数，通过构造函数来封装数据，最终得到一个统一的类型。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 因为Json::Value已经实现了各种数据类型的构造函数</span></span><br><span class="line"><span class="built_in">Value</span>(ValueType type = nullValue);</span><br><span class="line"><span class="built_in">Value</span>(Int value);</span><br><span class="line"><span class="built_in">Value</span>(UInt value);</span><br><span class="line"><span class="built_in">Value</span>(Int64 value);</span><br><span class="line"><span class="built_in">Value</span>(UInt64 value);</span><br><span class="line"><span class="built_in">Value</span>(<span class="type">double</span> value);</span><br><span class="line"><span class="built_in">Value</span>(<span class="type">const</span> <span class="type">char</span>* value);</span><br><span class="line"><span class="built_in">Value</span>(<span class="type">const</span> <span class="type">char</span>* begin, <span class="type">const</span> <span class="type">char</span>* end);</span><br><span class="line"><span class="built_in">Value</span>(<span class="type">bool</span> value);</span><br><span class="line"><span class="built_in">Value</span>(<span class="type">const</span> Value&amp; other);</span><br><span class="line"><span class="built_in">Value</span>(Value&amp;&amp; other);</span><br></pre></td></tr></table></figure>

<p><strong>检测保存的数据类型</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 检测保存的数据类型</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isNull</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isBool</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isInt</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isInt64</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isUInt</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isUInt64</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isIntegral</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isDouble</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isNumeric</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isString</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isArray</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isObject</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>将Value对象转换为实际类型</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Int <span class="title">asInt</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">UInt <span class="title">asUInt</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">Int64 <span class="title">asInt64</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">UInt64 <span class="title">asUInt64</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">LargestInt <span class="title">asLargestInt</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">LargestUInt <span class="title">asLargestUInt</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">JSONCPP_STRING <span class="title">asString</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">float</span> <span class="title">asFloat</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">asDouble</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">asBool</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> <span class="type">char</span>* <span class="title">asCString</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>对json数组的操作</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ArrayIndex <span class="title">size</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">Value&amp; <span class="keyword">operator</span>[](ArrayIndex index);</span><br><span class="line">Value&amp; <span class="keyword">operator</span>[](<span class="type">int</span> index);</span><br><span class="line"><span class="type">const</span> Value&amp; <span class="keyword">operator</span>[](ArrayIndex index) <span class="type">const</span>;</span><br><span class="line"><span class="type">const</span> Value&amp; <span class="keyword">operator</span>[](<span class="type">int</span> index) <span class="type">const</span>;</span><br><span class="line"><span class="comment">// 根据下标的index返回这个位置的value值</span></span><br><span class="line"><span class="comment">// 如果没找到这个index对应的value, 返回第二个参数defaultValue</span></span><br><span class="line"><span class="function">Value <span class="title">get</span><span class="params">(ArrayIndex index, <span class="type">const</span> Value&amp; defaultValue)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">Value&amp; <span class="title">append</span><span class="params">(<span class="type">const</span> Value&amp; value)</span></span>;</span><br><span class="line"><span class="function">const_iterator <span class="title">begin</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">const_iterator <span class="title">end</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">iterator <span class="title">begin</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">iterator <span class="title">end</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>对json对象的操作</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Value&amp; <span class="keyword">operator</span>[](<span class="type">const</span> <span class="type">char</span>* key);</span><br><span class="line"><span class="type">const</span> Value&amp; <span class="keyword">operator</span>[](<span class="type">const</span> <span class="type">char</span>* key) <span class="type">const</span>;</span><br><span class="line">Value&amp; <span class="keyword">operator</span>[](<span class="type">const</span> JSONCPP_STRING&amp; key);</span><br><span class="line"><span class="type">const</span> Value&amp; <span class="keyword">operator</span>[](<span class="type">const</span> JSONCPP_STRING&amp; key) <span class="type">const</span>;</span><br><span class="line">Value&amp; <span class="keyword">operator</span>[](<span class="type">const</span> StaticString&amp; key);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过key, 得到value值</span></span><br><span class="line"><span class="function">Value <span class="title">get</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* key, <span class="type">const</span> Value&amp; defaultValue)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">Value <span class="title">get</span><span class="params">(<span class="type">const</span> JSONCPP_STRING&amp; key, <span class="type">const</span> Value&amp; defaultValue)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function">Value <span class="title">get</span><span class="params">(<span class="type">const</span> CppTL::ConstString&amp; key, <span class="type">const</span> Value&amp; defaultValue)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 得到对象中所有的键值</span></span><br><span class="line"><span class="keyword">typedef</span> std::vector&lt;std::string&gt; Members;</span><br><span class="line"><span class="function">Members <span class="title">getMemberNames</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>将Value对象数据序列化为string</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 序列化得到的字符串有样式 -&gt; 带换行 -&gt; 方便阅读</span></span><br><span class="line"><span class="comment">// 写配置文件的时候</span></span><br><span class="line"><span class="function">std::string <span class="title">toStyledString</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-2-2-FastWriter-类"><a href="#4-2-2-FastWriter-类" class="headerlink" title="4.2.2 FastWriter 类"></a>4.2.2 FastWriter 类</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将数据序列化 -&gt; 单行</span></span><br><span class="line"><span class="comment">// 进行数据的网络传输</span></span><br><span class="line">std::string Json::FastWriter::<span class="built_in">write</span>(<span class="type">const</span> Value&amp; root);</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="4-2-3-Reader-类"><a href="#4-2-3-Reader-类" class="headerlink" title="4.2.3 Reader 类"></a>4.2.3 Reader 类</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> Json::Reader::<span class="built_in">parse</span>(<span class="type">const</span> std::string&amp; document,</span><br><span class="line">    Value&amp; root, <span class="type">bool</span> collectComments = <span class="literal">true</span>);</span><br><span class="line">    参数:</span><br><span class="line">        - document: json格式字符串</span><br><span class="line">        - root: 传出参数, 存储了json字符串中解析出的数据</span><br><span class="line">        - collectComments: 是否保存json字符串中的注释信息</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过begindoc和enddoc指针定位一个json字符串</span></span><br><span class="line"><span class="comment">// 这个字符串可以是完成的json字符串, 也可以是部分json字符串</span></span><br><span class="line"><span class="type">bool</span> Json::Reader::<span class="built_in">parse</span>(<span class="type">const</span> <span class="type">char</span>* beginDoc, <span class="type">const</span> <span class="type">char</span>* endDoc,</span><br><span class="line">    Value&amp; root, <span class="type">bool</span> collectComments = <span class="literal">true</span>);</span><br><span class="line">	</span><br><span class="line"><span class="comment">// write的文件流  -&gt; ofstream</span></span><br><span class="line"><span class="comment">// read的文件流   -&gt; ifstream</span></span><br><span class="line"><span class="comment">// 假设要解析的json数据在磁盘文件中</span></span><br><span class="line"><span class="comment">// is流对象指向一个磁盘文件, 读操作</span></span><br><span class="line"><span class="type">bool</span> Json::Reader::<span class="built_in">parse</span>(std::istream&amp; is, Value&amp; root, <span class="type">bool</span> collectComments = <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="4-3-VS的配置"><a href="#4-3-VS的配置" class="headerlink" title="4.3 VS的配置"></a>4.3 VS的配置</h2><p>如果想要在VS中使用编译出的<code>jsoncpp</code>库，我们还需要做如下配置：</p>
<h3 id="4-3-1-头文件"><a href="#4-3-1-头文件" class="headerlink" title="4.3.1 头文件"></a>4.3.1 头文件</h3><p>在编码过程中需要在项目文件中包含从github下载得到的头文件，有两种处理方式：</p>
<ol>
<li><p>将头文件放到项目目录下，直接被项目包含引用</p>
</li>
<li><p>将头文件放到一个本地固定目录，以后就不再动了，在VS项目属性中设置包含这个目录，推荐这种</p>
</li>
</ol>
<p><img src="/img/b.9.png" alt="在这里插入图片描述"></p>
<p>另外，在这个<code>include</code>目录中还有一个<code>json</code>子目录，所有的头文件都在这个子目录中，我们不要破坏这个目录结构：</p>
<p><img src="/img/b.10.png" alt="在这里插入图片描述"></p>
<p>在包含需要的头文件的时候，使用如下这种方式：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;json/json.h&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>把本地的头文件目录在项目属性窗口中进行配置：</p>
<p><img src="/img/b.11.png" alt="在这里插入图片描述"></p>
<p>这里头文件是放到了C盘的jsoncpp目录中：</p>
<p><img src="/img/b.12.png" alt="在这里插入图片描述"></p>
<hr>
<h3 id="4-3-2-库文件"><a href="#4-3-2-库文件" class="headerlink" title="4.3.2 库文件"></a>4.3.2 库文件</h3><p>我这里也是将生成的<code>jsoncpp.lib</code>和<code>jsoncpp.dll</code>放到了C盘（<code>C:\jsoncpp\lib</code>），在VS项目中需要指定这个库路径：</p>
<p><img src="/img/b.13.png" alt="在这里插入图片描述"><br><img src="/img/b.14.png" alt="在这里插入图片描述"></p>
<p>另外，还需要告诉VS需要加载的动态库是哪一个</p>
<p><img src="/img/b.15.png" alt="在这里插入图片描述"></p>
<p>此处指定的是动态库对应的<code>lib</code>文件，也就是<code>jsoncpp.lib</code></p>
<p><img src="/img/b.16.png" alt="在这里插入图片描述"></p>
<p>配置完成之后，如果项目中使用了<code>jsoncpp</code>就可以编译通过了。在程序执行的时候，如果提示找不到<code>jsoncpp</code>的动态库，<code>把 jsoncpp.dll 拷贝到可执行所在的目录下就可以解决了。</code></p>
<hr>
<h2 id="4-3-示例代码"><a href="#4-3-示例代码" class="headerlink" title="4.3 示例代码"></a>4.3 示例代码</h2><p>比如：我们要将下面这个Json数组写入的一个文件中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="number">12</span>, </span><br><span class="line">    <span class="number">12.34</span>, </span><br><span class="line">    <span class="literal">true</span>, </span><br><span class="line">    <span class="string">&quot;tom&quot;</span>, </span><br><span class="line">    [<span class="string">&quot;jack&quot;</span>, <span class="string">&quot;ace&quot;</span>, <span class="string">&quot;robin&quot;</span>], </span><br><span class="line">    &#123;<span class="string">&quot;sex&quot;</span>:<span class="string">&quot;man&quot;</span>, <span class="string">&quot;girlfriend&quot;</span>:<span class="string">&quot;lucy&quot;</span>&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;json/json.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Json;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">writeJson</span>();</span><br><span class="line">    <span class="built_in">readJson</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="4-3-1-写json文件"><a href="#4-3-1-写json文件" class="headerlink" title="4.3.1 写json文件"></a>4.3.1 写json文件</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">writeJson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 将最外层的数组看做一个Value</span></span><br><span class="line">    <span class="comment">// 最外层的Value对象创建</span></span><br><span class="line">    Value root;</span><br><span class="line">    <span class="comment">// Value有一个参数为int 行的构造函数</span></span><br><span class="line">    root.<span class="built_in">append</span>(<span class="number">12</span>);	<span class="comment">// 参数进行隐式类型转换</span></span><br><span class="line">    root.<span class="built_in">append</span>(<span class="number">12.34</span>);</span><br><span class="line">    root.<span class="built_in">append</span>(<span class="literal">true</span>);</span><br><span class="line">    root.<span class="built_in">append</span>(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建并初始化一个子数组</span></span><br><span class="line">    Value subArray;</span><br><span class="line">    subArray.<span class="built_in">append</span>(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">    subArray.<span class="built_in">append</span>(<span class="string">&quot;ace&quot;</span>);</span><br><span class="line">    subArray.<span class="built_in">append</span>(<span class="string">&quot;robin&quot;</span>);</span><br><span class="line">    root.<span class="built_in">append</span>(subArray);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建并初始化子对象</span></span><br><span class="line">    Value subObj;</span><br><span class="line">    subObj[<span class="string">&quot;sex&quot;</span>] = <span class="string">&quot;woman&quot;</span>;  <span class="comment">// 添加键值对</span></span><br><span class="line">    subObj[<span class="string">&quot;girlfriend&quot;</span>] = <span class="string">&quot;lucy&quot;</span>;</span><br><span class="line">    root.<span class="built_in">append</span>(subObj);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 序列化</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 1</span></span><br><span class="line">    <span class="comment">// 有格式的字符串</span></span><br><span class="line">    string str = root.<span class="built_in">toStyledString</span>();</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    FastWriter f;</span><br><span class="line">    string str = f.<span class="built_in">write</span>(root);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="comment">// 将序列化的字符串写磁盘文件</span></span><br><span class="line">    <span class="function">ofstream <span class="title">ofs</span><span class="params">(<span class="string">&quot;test.json&quot;</span>)</span></span>;</span><br><span class="line">    ofs &lt;&lt; str;</span><br><span class="line">    ofs.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="4-3-2-读json文件"><a href="#4-3-2-读json文件" class="headerlink" title="4.3.2 读json文件"></a>4.3.2 读json文件</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">readJson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 1. 将磁盘文件中的json字符串读到磁盘文件</span></span><br><span class="line">    <span class="function">ifstream <span class="title">ifs</span><span class="params">(<span class="string">&quot;test.json&quot;</span>)</span></span>;</span><br><span class="line">    <span class="comment">// 2. 反序列化 -&gt; value对象</span></span><br><span class="line">    Value root;</span><br><span class="line">    Reader r;</span><br><span class="line">    r.<span class="built_in">parse</span>(ifs, root);</span><br><span class="line">    <span class="comment">// 3. 从value对象中将数据依次读出</span></span><br><span class="line">    <span class="keyword">if</span> (root.<span class="built_in">isArray</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 数组, 遍历数组</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; root.<span class="built_in">size</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 依次取出各个元素, 类型是value类型</span></span><br><span class="line">            Value item = root[i];</span><br><span class="line">            <span class="comment">// 判断item中存储的数据的类型</span></span><br><span class="line">            <span class="keyword">if</span> (item.<span class="built_in">isString</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; item.<span class="built_in">asString</span>() &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (item.<span class="built_in">isInt</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; item.<span class="built_in">asInt</span>() &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (item.<span class="built_in">isBool</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; item.<span class="built_in">asBool</span>() &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (item.<span class="built_in">isDouble</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; item.<span class="built_in">asFloat</span>() &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (item.<span class="built_in">isArray</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; item.<span class="built_in">size</span>(); ++j)</span><br><span class="line">                &#123;</span><br><span class="line">                    cout &lt;&lt; item[j].<span class="built_in">asString</span>() &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (item.<span class="built_in">isObject</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 对象</span></span><br><span class="line">                <span class="comment">// 得到所有的key</span></span><br><span class="line">                Value::Members keys = item.<span class="built_in">getMemberNames</span>();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; keys.<span class="built_in">size</span>(); ++k)</span><br><span class="line">                &#123;</span><br><span class="line">                    cout &lt;&lt; keys.<span class="built_in">at</span>(k) &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; item[keys[k]] &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">    	&#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面读Json文件的这段代码中，对读出的每个Value类型的节点进行了类型判断，其实一般情况下是不需要做这样的判断的，因为我们在解析的时候是明确地知道该节点的类型的。</p>
<p>虽然Json这种格式无外乎数组和对象两种，但是需求不同我们设计的Json文件的组织方式也不同，一般都是特定的文件对应特定的解析函数，一个解析函数可以解析任何的Json文件这种设计思路是坚决不推荐的。</p>
<hr>
<h1 id="5-Qt程序打包和发布"><a href="#5-Qt程序打包和发布" class="headerlink" title="5. Qt程序打包和发布"></a>5. Qt程序打包和发布</h1><h2 id="5-1-程序的发布"><a href="#5-1-程序的发布" class="headerlink" title="5.1 程序的发布"></a>5.1 程序的发布</h2><h3 id="5-1-1-生成Release版程序"><a href="#5-1-1-生成Release版程序" class="headerlink" title="5.1.1 生成Release版程序"></a>5.1.1 生成Release版程序</h3><p>在编写Qt程序的时候，不管我们使用的什么样的IDE都可以进行编译版本的切换，如果要发布程序需要切换为Release版本（Debug为调试版本），编译器会对生成的Release版可执行程序进行优化，生成的可执行程序会更小。这里以QtCreator为例，截图如下：</p>
<p><img src="/img/b.17.png" alt="在这里插入图片描述"></p>
<p>模式选择完毕之后开始构建当前项目，最后找到生成的带<code>Release</code>后缀的构建目录，如下图所示：</p>
<p><img src="/img/b.18.png" alt="在这里插入图片描述"></p>
<p>进图到release目录中，在里面就能找到我们要的可执行程序了</p>
<p><img src="/img/b.19.png" alt="在这里插入图片描述"></p>
<hr>
<h3 id="5-1-2-发布"><a href="#5-1-2-发布" class="headerlink" title="5.1.2 发布"></a>5.1.2 发布</h3><p>生成的可执行程序在运行的时候需要加载相关的Qt库文件，因此需要将这些动态库一并发布给使用者，Qt官方给我们提供了相关的发布工具，通过这个工具就可以非常轻松的找出这些动态库文件了，这个工具叫做<code>windeployqt.exe</code>，该文件位于Qt安装目录的编译套件目录的bin目录中，以我本地为例：<code>C:\Qt\5.15.2\mingw81_64\bin</code></p>
<ul>
<li>C:\Qt是Qt的安装目录</li>
<li>5.15.2是Qt的版本</li>
<li>mingw81_64是编译套件目录</li>
<li>bin存储windeployqt.exe文件的目录</li>
</ul>
<p>如果已经将这个路径设置到环境变量中了，那么在当前操作系统的任意目录下都可以访问<code>windeployqt.exe</code></p>
<p>知道Qt提供的这个工具之后就可以继续向下进行了，首先将生成的<code>Release</code>版本的可执行程序放到一个新建的空目录中：<br><img src="/img/b.20.png" alt="在这里插入图片描述"></p>
<p>进入到这个目录，按住键盘<code>shift</code>键然后鼠标右键就可以弹出一个右键菜单<br><img src="/img/b.21.png" alt="在这里插入图片描述"></p>
<p>打开Powershell窗口执行命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LordCard.exe 是可执行程序的名字</span></span><br><span class="line"><span class="comment"># windeployqt.exe 的后缀 .exe 可以省略不写</span></span><br><span class="line">windeployqt.exe LordCard.exe</span><br></pre></td></tr></table></figure>

<p><img src="/img/b.22.png" alt="在这里插入图片描述"></p>
<p>这样<code>LordCard.exe</code>需要的动态库会被全部拷贝到当前的目录中，如下图：<br><img src="/img/b.23.png" alt="在这里插入图片描述"></p>
<p><code>使用这种方式Qt会将一些用不到的动态库也拷贝到当前的目录中，如果确定用不到可以手动将其删除，如果不在意这些，完全可以不用理会，选择后者。</code></p>
<p>现在一个绿色免安装版的程序就得到了，可以将这个目录打个压缩包发送</p>
<hr>
<h2 id="5-2-Qt程序打包"><a href="#5-2-Qt程序打包" class="headerlink" title="5.2 Qt程序打包"></a>5.2 Qt程序打包</h2><p>将应用程序和相关的动态库打包成安装包的工具有很多，我自己用过两个一个是<code>NIS Edit</code>，一个是<code>Inno Setup</code>这是一个免费的 Windows 安装程序制作软件，小巧、简便、精美。</p>
<p><a target="_blank" rel="noopener" href="http://www.jrsoftware.org/isdl.php#stable">官方下载地址</a></p>
<p>其实这两个工具的使用方法是几乎一样的，下面拿<code>Inno Setup</code>使用举例。</p>
<p><strong>第一步：创建一个带向导的脚本文件</strong><br><img src="/img/b.24.png" alt="在这里插入图片描述"></p>
<p><strong>第二步：直接 Next，不要创建空的脚本文件</strong></p>
<p><img src="/img/b.25.png" alt="在这里插入图片描述"></p>
<p><strong>第三步：填写相关的应用程序信息</strong><br><img src="/img/b.26.png" alt="在这里插入图片描述"></p>
<p><strong>第四步：指定应用程序的安装目录相关的信息</strong><br><img src="/img/b.27.png" alt="在这里插入图片描述"></p>
<p><strong>第五步：选择可执行程序和相关的动态库，此处参考的是前边的 1.2 章节中的目录</strong><br><img src="/img/b.28.png" alt="在这里插入图片描述"></p>
<p>基于这个目录选择相关的文件和目录：<br><img src="/img/b.29.png" alt="在这里插入图片描述"></p>
<p>由于可执行程序关系的动态库有很多，所以可以直接添加动态库的目录，选中对应的目录之后，如果里边还有子目录会弹出如下对话框，选择是即可，需要包含这些子目录。<br><img src="/img/b.30.png" alt="在这里插入图片描述"></p>
<p><strong>第六步：给可执行程序关联本地的某种格式的磁盘文件（比如记事本程序会自动关联本地的 .txt 文件），对于我的可执行程序来说无需关联，因此没有做任何设置，直接下一步</strong><br><img src="/img/b.31.png" alt="在这里插入图片描述"></p>
<p><strong>第七步：给应用程序创建快捷方式，此处没有进行任何设置，使用的默认选项</strong><br><img src="/img/b.32.png" alt="在这里插入图片描述"></p>
<p><strong>第八步：指定许可文件，文件中的内容会显示到安装向导的相关窗口中，可以选择不指定，直接跳过。</strong><br><img src="/img/b.33.png" alt="在这里插入图片描述"></p>
<p><strong>第九步：选择安装模式（给系统的当前用户安装还是给所有用户安装），根据自己喜好指定即可</strong><br><img src="/img/b.34.png" alt="在这里插入图片描述"></p>
<p><strong>第十步：选择安装语言（这个工具没有提供中文，因此只能选择英文）</strong><br><img src="/img/b.35.png" alt="在这里插入图片描述"></p>
<p><strong>第十一步：指定安装包文件的相关信息</strong><br><img src="/img/b.36.png" alt="在这里插入图片描述"></p>
<p><strong>第十二步：向导结束</strong><br><img src="/img/b.37.png" alt="在这里插入图片描述"></p>
<p><strong>第十三步：提示是否要编译生成的脚本文件，脚本编译完成之后，安装包就生成了。</strong></p>
<p><img src="/img/b.38.png" alt="在这里插入图片描述"></p>
<p>之后弹出第二个对话框，建议通过向导生成的这个脚本文件，这样以后就可以直接基于这个脚本打包程序生成安装包了。<br><img src="/img/b.39.png" alt="在这里插入图片描述"></p>
<p><strong>编译完成之后，就可以去保存脚本文件的目录找生成的安装文件了</strong><br><img src="/img/b.40.png" alt="在这里插入图片描述"></p>
<hr>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JSON/">JSON</a></div><div class="post_share"><div class="social-share" data-image="/pic/5.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/22/%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AF%87/" title="基本数据结构篇"><img class="cover" src="/pic/10.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">基本数据结构篇</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/22/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%A5%97%E6%8E%A5%E5%AD%97%E9%80%9A%E4%BF%A1/" title="多线程和套接字通信"><img class="cover" src="/pic/5.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">多线程和套接字通信</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/pic/avater.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">9TSe</div><div class="author-info__description">难正经</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">44</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/9tse"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/9TSe" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:9TSewer@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">C++部分,Qt,Linux,文章摘于 https://subingwen.cn/</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-JSON"><span class="toc-text">1. JSON</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-Json%E6%95%B0%E7%BB%84"><span class="toc-text">1.1 Json数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Json%E5%AF%B9%E8%B1%A1"><span class="toc-text">1.2 Json对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">1.3 注意事项</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Qt%E4%B8%ADJSON%E6%93%8D%E4%BD%9C"><span class="toc-text">2. Qt中JSON操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-QJsonValue"><span class="toc-text">2.1 QJsonValue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-QJsonObject"><span class="toc-text">2.2 QJsonObject</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-QJsonArray"><span class="toc-text">2.3 QJsonArray</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-QJsonDocument"><span class="toc-text">2.4 QJsonDocument</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E4%B8%BE%E4%BE%8B"><span class="toc-text">2.5 举例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-1-%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-text">2.5.1 写文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2-%E8%AF%BB%E6%96%87%E4%BB%B6"><span class="toc-text">2.5.2 读文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-cjson%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">3. cjson库的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-cJSON%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-text">3.1 cJSON结构体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-cJson-API"><span class="toc-text">3.2 cJson API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E6%95%B0%E6%8D%AE%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-text">3.2.1 数据的封装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-Json%E5%AF%B9%E8%B1%A1%E6%93%8D%E4%BD%9C"><span class="toc-text">3.2.2 Json对象操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-Json%E6%95%B0%E7%BB%84%E6%93%8D%E4%BD%9C"><span class="toc-text">3.2.3 Json数组操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-4-%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">3.2.4 序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-5-Json%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E8%A7%A3%E6%9E%90"><span class="toc-text">3.2.5 Json字符串的解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-6-%E5%86%85%E5%AD%98%E9%87%8A%E6%94%BE"><span class="toc-text">3.2.6 内存释放</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-Json%E6%95%B0%E6%8D%AE%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-text">3.3 Json数据的封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-Json%E5%AF%B9%E8%B1%A1%E6%93%8D%E4%BD%9C%E4%B8%BE%E4%BE%8B"><span class="toc-text">3.3.1 Json对象操作举例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-Json%E6%95%B0%E7%BB%84%E6%93%8D%E4%BD%9C%E4%B8%BE%E4%BE%8B"><span class="toc-text">3.3.2 Json数组操作举例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-3-Json%E5%AF%B9%E8%B1%A1%E3%80%81%E6%95%B0%E7%BB%84%E5%B5%8C%E5%A5%97%E4%BD%BF%E7%94%A8"><span class="toc-text">3.3.3 Json对象、数组嵌套使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E8%A7%A3%E6%9E%90Json%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">3.4 解析Json字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-%E8%A7%A3%E6%9E%90Json%E5%AF%B9%E8%B1%A1"><span class="toc-text">3.4.1 解析Json对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-2-%E8%A7%A3%E6%9E%90%E5%B5%8C%E5%A5%97%E7%9A%84Json%E5%AF%B9%E8%B1%A1"><span class="toc-text">3.4.2 解析嵌套的Json对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-3-%E8%A7%A3%E6%9E%90Json%E6%95%B0%E7%BB%84"><span class="toc-text">3.4.3 解析Json数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-4-%E8%A7%A3%E6%9E%90%E5%B5%8C%E5%A5%97%E7%9A%84Json%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E7%BB%84"><span class="toc-text">3.4.4 解析嵌套的Json对象和数组</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-jsoncpp%E7%9A%84%E7%BC%96%E8%AF%91%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-text">4. jsoncpp的编译和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E4%B8%8B%E8%BD%BD%E5%92%8C%E7%BC%96%E8%AF%91"><span class="toc-text">4.1 下载和编译</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-%E4%B8%8B%E8%BD%BD"><span class="toc-text">4.1.1 下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-%E7%94%9F%E6%88%90VS%E9%A1%B9%E7%9B%AE"><span class="toc-text">4.1.2 生成VS项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-3-%E7%BC%96%E8%AF%91"><span class="toc-text">4.1.3 编译</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-jsoncpp-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">4.2 jsoncpp 的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-Value%E7%B1%BB"><span class="toc-text">4.2.1 Value类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-2-FastWriter-%E7%B1%BB"><span class="toc-text">4.2.2 FastWriter 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-3-Reader-%E7%B1%BB"><span class="toc-text">4.2.3 Reader 类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-VS%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-text">4.3 VS的配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1-%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="toc-text">4.3.1 头文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-2-%E5%BA%93%E6%96%87%E4%BB%B6"><span class="toc-text">4.3.2 库文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-text">4.3 示例代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1-%E5%86%99json%E6%96%87%E4%BB%B6"><span class="toc-text">4.3.1 写json文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-2-%E8%AF%BBjson%E6%96%87%E4%BB%B6"><span class="toc-text">4.3.2 读json文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-Qt%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8C%85%E5%92%8C%E5%8F%91%E5%B8%83"><span class="toc-text">5. Qt程序打包和发布</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%8F%91%E5%B8%83"><span class="toc-text">5.1 程序的发布</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-1-%E7%94%9F%E6%88%90Release%E7%89%88%E7%A8%8B%E5%BA%8F"><span class="toc-text">5.1.1 生成Release版程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-2-%E5%8F%91%E5%B8%83"><span class="toc-text">5.1.2 发布</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-Qt%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8C%85"><span class="toc-text">5.2 Qt程序打包</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/27/%E9%9F%B3%E8%A7%86%E9%A2%911/" title="音视频入门"><img src="/pic/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="音视频入门"/></a><div class="content"><a class="title" href="/2023/11/27/%E9%9F%B3%E8%A7%86%E9%A2%911/" title="音视频入门">音视频入门</a><time datetime="2023-11-27T14:24:43.000Z" title="发表于 2023-11-27 22:24:43">2023-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/27/algorithm-other/" title="代码随想录-补充篇"><img src="/pic/10.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="代码随想录-补充篇"/></a><div class="content"><a class="title" href="/2023/11/27/algorithm-other/" title="代码随想录-补充篇">代码随想录-补充篇</a><time datetime="2023-11-27T14:24:29.000Z" title="发表于 2023-11-27 22:24:29">2023-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/27/dp/" title="动态规划"><img src="/pic/10.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="动态规划"/></a><div class="content"><a class="title" href="/2023/11/27/dp/" title="动态规划">动态规划</a><time datetime="2023-11-27T14:00:24.000Z" title="发表于 2023-11-27 22:00:24">2023-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/03/MysqlAPI/" title="MySQL 在C/C++中的API"><img src="/pic/8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL 在C/C++中的API"/></a><div class="content"><a class="title" href="/2023/11/03/MysqlAPI/" title="MySQL 在C/C++中的API">MySQL 在C/C++中的API</a><time datetime="2023-11-03T02:12:53.000Z" title="发表于 2023-11-03 10:12:53">2023-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/03/stu-msg-manage-system/" title="学生管理系统"><img src="/pic/3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="学生管理系统"/></a><div class="content"><a class="title" href="/2023/11/03/stu-msg-manage-system/" title="学生管理系统">学生管理系统</a><time datetime="2023-11-03T02:12:41.000Z" title="发表于 2023-11-03 10:12:41">2023-11-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 9TSe</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>