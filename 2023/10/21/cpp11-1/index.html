<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>C++11 | 9TSe</title><meta name="author" content="9TSe"><meta name="copyright" content="9TSe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、decltype(RTTI)  RTTI 即 run time type identification(程序运行对对象的类型识别)auto和decltype  123456789101112131415161718&#x2F;&#x2F;类型推导RTTI : run time type identification&#x2F;&#x2F;程序运行起来对对象的类型识别int a&amp;#123; 10 &amp;#125;, b&amp;#123; 20">
<meta property="og:type" content="article">
<meta property="og:title" content="C++11">
<meta property="og:url" content="http://example.com/2023/10/21/cpp11-1/index.html">
<meta property="og:site_name" content="9TSe">
<meta property="og:description" content="一、decltype(RTTI)  RTTI 即 run time type identification(程序运行对对象的类型识别)auto和decltype  123456789101112131415161718&#x2F;&#x2F;类型推导RTTI : run time type identification&#x2F;&#x2F;程序运行起来对对象的类型识别int a&amp;#123; 10 &amp;#125;, b&amp;#123; 20">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/pic/2.png">
<meta property="article:published_time" content="2023-10-21T13:07:48.000Z">
<meta property="article:modified_time" content="2023-10-22T01:31:39.219Z">
<meta property="article:author" content="9TSe">
<meta property="article:tag" content="文件IO">
<meta property="article:tag" content="C++特性">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/pic/2.png"><link rel="shortcut icon" href="/pic/12.png"><link rel="canonical" href="http://example.com/2023/10/21/cpp11-1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'C++11',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-10-22 09:31:39'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="9TSe" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/pic/avater.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">43</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('/pic/2.png')"><nav id="nav"><span id="blog-info"><a href="/" title="9TSe"><img class="site-icon" src="/pic/9.png"/></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">C++11</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-21T13:07:48.000Z" title="发表于 2023-10-21 21:07:48">2023-10-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-22T01:31:39.219Z" title="更新于 2023-10-22 09:31:39">2023-10-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C++</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="C++11"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr>
<h1 id="一、decltype-RTTI"><a href="#一、decltype-RTTI" class="headerlink" title="一、decltype(RTTI)"></a>一、decltype(RTTI)</h1><hr>
<blockquote>
<p>RTTI 即 run time type identification(程序运行对对象的类型识别)<br>auto和decltype</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类型推导RTTI : run time type identification</span></span><br><span class="line"><span class="comment">//程序运行起来对对象的类型识别</span></span><br><span class="line"><span class="type">int</span> a&#123; <span class="number">10</span> &#125;, b&#123; <span class="number">20</span> &#125;;</span><br><span class="line"><span class="keyword">decltype</span>(a + b) c = <span class="number">30</span>; <span class="comment">//定一个c和a+b是一个类型的对象</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(c).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; c &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> d = a+b;</span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(d).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; d &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//auto不能作为形参和返回值</span></span><br><span class="line"><span class="comment">/*auto func(auto e)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">	return e;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; func(a) &lt;&lt; endl;*/</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>虽然auto不能作为函数的形参和返回值<br>但是在C++14的标准中就有了lambda表达式内可以有auto</p>
</blockquote>
<hr>
<h1 id="二、C-11中的新容器"><a href="#二、C-11中的新容器" class="headerlink" title="二、C++11中的新容器"></a>二、C++11中的新容器</h1><hr>
<blockquote>
<p>c++98容器:<br>    string &#x2F; vector &#x2F; list &#x2F; deque &#x2F; map &#x2F; set &#x2F; bitset + stack &#x2F; queue &#x2F; priority_queue<br>    c++11新容器:<br>    array(定长数组) &#x2F; forward_list(单链表)<br>    array: #include&lt; array&gt;  缺点:定长+存储数据的空间在 栈上,栈的空间本来就不大<br>    forward_list: #include&lt; forward_list &gt;  缺点:不支持尾插尾删+insert数据也是在当前位置的后面<br>unordered_map&#x2F;unordered_set : 效率高于map &#x2F; set,推荐</p>
</blockquote>
<hr>
<h1 id="三、默认成员函数的控制"><a href="#三、默认成员函数的控制" class="headerlink" title="三、默认成员函数的控制"></a>三、默认成员函数的控制</h1><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">B</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//1.要生成默认构造函数</span></span><br><span class="line">	<span class="built_in">B</span>() = <span class="keyword">default</span>;  <span class="comment">//加入default关键字,即可仍然生成默认构造函数</span></span><br><span class="line">	<span class="built_in">B</span>(<span class="type">const</span> <span class="type">int</span>&amp; b) <span class="comment">//构造函数</span></span><br><span class="line">		:_b(b)</span><br><span class="line">	&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2.不能拷贝和赋值(防拷贝)</span></span><br><span class="line">	<span class="comment">//c++98</span></span><br><span class="line">	<span class="built_in">B</span>(<span class="type">const</span> B&amp; b);</span><br><span class="line">	B&amp; <span class="keyword">operator</span>=(<span class="type">const</span> B&amp; b);</span><br><span class="line">	<span class="comment">//1.通过只声明,不定义的方式,使得链接失败,但是可以在外部定义</span></span><br><span class="line">	<span class="comment">//2.private限定声明</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//c++11</span></span><br><span class="line">	<span class="built_in">B</span>(<span class="type">const</span> B&amp; b) = <span class="keyword">delete</span>;</span><br><span class="line">	B&amp; <span class="keyword">operator</span>=(<span class="type">const</span> B&amp; b) = <span class="keyword">delete</span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">//B(const B&amp; b);</span></span><br><span class="line">	<span class="comment">//B&amp; operator=(const B&amp; b); //private限定声明</span></span><br><span class="line">	<span class="type">int</span> _b = <span class="number">10</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">B::<span class="built_in">B</span>(<span class="type">const</span> B&amp; b) <span class="comment">//可以在外部定义</span></span><br><span class="line">&#123;&#125;				 <span class="comment">//delete删除仍然可以在外部定义,但是拷贝构造时就会报错</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test4</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	B b1;     <span class="comment">//因为有显示构造函数了,没有生成默认构造函数</span></span><br><span class="line">	<span class="function">B <span class="title">b2</span><span class="params">(b1)</span></span>; <span class="comment">//内部只声明,外部定义,仍然可以使用拷贝构造</span></span><br><span class="line">	b1 = b2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="四、右值引用"><a href="#四、右值引用" class="headerlink" title="四、右值引用"></a>四、右值引用</h1><hr>
<h2 id="1-右值引用的基本使用"><a href="#1-右值引用的基本使用" class="headerlink" title="1.右值引用的基本使用"></a>1.右值引用的基本使用</h2><blockquote>
<pre><code>左右不是方向,和左移右移一样,是C留下的坑
左值通常是变量
右值通常是常量,表达式或者函数返回值等临时常量
</code></pre>
</blockquote>
<pre><code>c++11将右值分为:纯右值 , 将亡值
纯右值:基本类型的常量或者临时对象
将亡值:自定义类型的临时对象
</code></pre>
<blockquote>
<p> 总结<br> 右值引用做参数和做返回值减少拷贝的本质是利用了移动构造和移动赋值<br> 左值引用和右值引用本质的作用都是减少拷贝,右值引用本质可以认为是弥补左值引用不足的地方,他们相辅相成</p>
</blockquote>
<blockquote>
<p>左值引用: 解决的是传参过程中和返回值过程中的拷贝<br> 做参数 : void push(T x) -&gt; void push(T&amp; x) 解决的是传参过程中减少拷贝<br> 做返回值 : T f2() -&gt; T&amp; f2() 解决的是返回值过程中的拷贝<br> 注意: 这里有限制,如果返回对象出了作用域不在了就不能传引用,这个左值引用无法解决,等待C++11右值引用解决</p>
</blockquote>
<blockquote>
<p>右值引用 : 解决的是传参后,push&#x2F;insert 函数内部将对象移动到容器空间上的问题 + 传值返回接受返回值的拷贝<br> 做参数 : void push(T&amp;&amp; x) 解决的push内部不再使用拷贝构造x到容器空间上,而是移动构造过去<br> 做返回值: T&amp;&amp; f2() 解决的外面调用接收f2() 返回对象的拷贝,T ret &#x3D; f2() , 这里就是右值引用的移动给构造,减少了拷贝</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun</span><span class="params">(<span class="type">const</span> T&amp; a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;void fun(const T&amp; a)&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun</span><span class="params">(<span class="type">const</span> T&amp;&amp; a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;void fun(const T&amp;&amp; a)&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test5</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> x = <span class="number">1</span>, y = <span class="number">2</span>, a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>&amp; b = a;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>&amp; e = <span class="number">10</span>;   </span><br><span class="line">	<span class="type">int</span>&amp; f = x + y;<span class="comment">//左值引用不能用右值初始化,这两段会出错</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//加上const,左值引用可以引用右值</span></span><br><span class="line">	<span class="type">const</span> <span class="type">int</span>&amp; e = <span class="number">10</span>;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span>&amp; f = x + y;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//右值引用</span></span><br><span class="line">	<span class="type">int</span>&amp;&amp; c = <span class="number">10</span>;</span><br><span class="line">	<span class="type">int</span>&amp;&amp; d = x + y;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//引用move后右值引用可以引用左值</span></span><br><span class="line">	<span class="type">int</span>&amp;&amp; m = a;  <span class="comment">//右值引用无法正常引用左值</span></span><br><span class="line">	<span class="type">int</span>&amp;&amp; m = <span class="built_in">move</span>(a);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fun</span>(x);  <span class="comment">//调左值引用</span></span><br><span class="line">	<span class="built_in">fun</span>(<span class="number">10</span>); <span class="comment">//调右值引用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-右值引用的作用"><a href="#2-右值引用的作用" class="headerlink" title="2.右值引用的作用"></a>2.右值引用的作用</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">String</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">String</span>(<span class="type">const</span> <span class="type">char</span>* str = <span class="string">&quot;&quot;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		_str = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(str) + <span class="number">1</span>];</span><br><span class="line">		<span class="built_in">strcpy</span>(_str, str);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//s2(s1)</span></span><br><span class="line">	<span class="built_in">String</span>(<span class="type">const</span> String&amp; s)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;String(const String&amp; s) - 深拷贝&quot;</span> &lt;&lt; endl;</span><br><span class="line">		_str = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(s._str) + <span class="number">1</span>];</span><br><span class="line">		<span class="built_in">strcpy</span>(_str, s._str);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">String</span>(String&amp;&amp; s) <span class="comment">//传递进一个将亡值,直接交换</span></span><br><span class="line">		:_str(<span class="literal">nullptr</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;String(const String&amp;&amp; s) - 移动拷贝&quot;</span> &lt;&lt; endl; <span class="comment">//相对于深拷贝,效率高</span></span><br><span class="line">		<span class="built_in">swap</span>(_str, s._str);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	String&amp; <span class="keyword">operator</span>=(<span class="type">const</span> String&amp; s)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span> != &amp;s)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">char</span>* newstr = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(s._str) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(newstr, s._str);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">delete</span>[] _str;</span><br><span class="line">			_str = newstr;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	String&amp; <span class="keyword">operator</span>=(String&amp;&amp; s)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;String&amp; operator=(String&amp;&amp; s) - 移动赋值 - 高效&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="built_in">swap</span>(_str, s._str);</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">String</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">delete</span>[] _str;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	String&amp; <span class="keyword">operator</span>+=(<span class="type">const</span> String&amp; s)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//this-&gt;append(s);</span></span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">//返回的是左值</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	String <span class="keyword">operator</span>+(<span class="type">const</span> String&amp; s)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">String <span class="title">ret</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">		<span class="comment">//ret.append(s);</span></span><br><span class="line">		<span class="keyword">return</span> ret; <span class="comment">//返回的是右值</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">char</span>* _str;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">String <span class="title">f</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">String <span class="title">tmp</span><span class="params">(str)</span></span>;</span><br><span class="line">	<span class="keyword">return</span> tmp; <span class="comment">//返回tmp临时拷贝对象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">test1</span><span class="params">()</span> <span class="comment">//右值引用</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">String <span class="title">s1</span><span class="params">(<span class="string">&quot;左值&quot;</span>)</span></span>; <span class="comment">//&quot;左值&quot;&quot;构造为string,性质为左值</span></span><br><span class="line">	<span class="function">String <span class="title">s2</span><span class="params">(s1)</span></span>;</span><br><span class="line">	<span class="function">String <span class="title">s3</span><span class="params">(move(s2))</span></span>; <span class="comment">//这里将s2转换为将亡值,移动拷贝</span></span><br><span class="line">	<span class="function">String <span class="title">s4</span><span class="params">(f(<span class="string">&quot;右值,将亡值&quot;</span>))</span></span>; <span class="comment">//移动拷贝</span></span><br><span class="line"></span><br><span class="line">	<span class="function">String <span class="title">s5</span><span class="params">(s1)</span></span>;</span><br><span class="line">	s5 = s1;</span><br><span class="line">	s5 = <span class="built_in">f</span>(<span class="string">&quot;rightval-dyingv&quot;</span>); <span class="comment">//tmp的临时拷贝对象就是将亡值</span></span><br><span class="line">	<span class="comment">//在string的标准库中同样有右值引用,类似的list,vector等</span></span><br><span class="line"></span><br><span class="line">	String s6 = s1 += s3;<span class="comment">//拷贝构造</span></span><br><span class="line">	String s7 = s1 + s2; <span class="comment">//移动构造</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//右值引用的应用场景在于深拷贝大型类,会导致大量效率的浪费</span></span><br><span class="line">	<span class="comment">//eg: vector&lt;vector&lt;int&gt;&gt; ...</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-emplace-back"><a href="#3-emplace-back" class="headerlink" title="3.emplace_back"></a>3.emplace_back</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">test2</span><span class="params">()</span> <span class="comment">//emplace_back</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//像vector,list等的插入基本都是两个重载实现,一个左值引用,一个右值引用</span></span><br><span class="line">	vector&lt;string&gt; v;</span><br><span class="line">	<span class="function">string <span class="title">s1</span><span class="params">(<span class="string">&quot;left val&quot;</span>)</span></span>;</span><br><span class="line">	<span class="type">int</span> val = <span class="number">123</span>;</span><br><span class="line">	v.<span class="built_in">push_back</span>(s1);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="string">&quot;right val&quot;</span>);   <span class="comment">//右值引用</span></span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="built_in">to_string</span>(val));<span class="comment">//右值引用</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//对于emplace_back</span></span><br><span class="line">	<span class="comment">//template&lt;class Arg&gt;</span></span><br><span class="line">	<span class="comment">//void emplace_back(Arg &amp;&amp; arg); //emplace_back只有右值引用,但由于模板的存在(模板的可变参数),可以传左值引用.</span></span><br><span class="line"></span><br><span class="line">	v.<span class="built_in">emplace_back</span>(s1); <span class="comment">//实际上并没有对其进行右值引用处理</span></span><br><span class="line">	v.<span class="built_in">emplace_back</span>(<span class="built_in">move</span>(s1));      <span class="comment">//此时才有右值处理</span></span><br><span class="line">	v.<span class="built_in">emplace_back</span>(<span class="string">&quot;right val&quot;</span>);   <span class="comment">//右值引用</span></span><br><span class="line">	<span class="comment">//综上发现,emplace_back和push_back用法和作用完全一样,没有孰优孰劣</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//但是emplace_back的特征在于以下</span></span><br><span class="line">	vector&lt;pair&lt;string, string&gt;&gt; vp;</span><br><span class="line">	<span class="function">pair&lt;string, string&gt; <span class="title">kv</span><span class="params">(<span class="string">&quot;left v&quot;</span>, <span class="string">&quot;left v&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	vp.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(<span class="string">&quot;right v&quot;</span>, <span class="string">&quot;right v&quot;</span>));</span><br><span class="line">	vp.<span class="built_in">emplace_back</span>(<span class="built_in">make_pair</span>(<span class="string">&quot;right v&quot;</span>, <span class="string">&quot;right v&quot;</span>));</span><br><span class="line">	vp.<span class="built_in">push_back</span>(kv);</span><br><span class="line">	vp.<span class="built_in">emplace_back</span>(kv);</span><br><span class="line">	</span><br><span class="line">	vp.<span class="built_in">emplace_back</span>(<span class="string">&quot;right v&quot;</span>, <span class="string">&quot;right v&quot;</span>); <span class="comment">//体现emplace_back模板的可变参数特点的地方(template)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-完美转发"><a href="#4-完美转发" class="headerlink" title="4.完美转发"></a>4.完美转发</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun</span><span class="params">(<span class="type">int</span>&amp; x)</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;leftv ref&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun</span><span class="params">(<span class="type">int</span>&amp;&amp; x)</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;rightv ref&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun</span><span class="params">(<span class="type">const</span> <span class="type">int</span>&amp; x)</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;const leftv ref&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun</span><span class="params">(<span class="type">const</span> <span class="type">int</span>&amp;&amp; x)</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;const rightv ref&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PerfectFoward</span><span class="params">(T&amp;&amp; t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//fun(t); //右值引用会在第二次之后参数传递过程中属性丢失,所以结果并不为我们所想</span></span><br><span class="line">	<span class="built_in">fun</span>(std::forward&lt;T&gt;(t)); <span class="comment">//加入forward关键字即可保留其属性,完美转发解决</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">test3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">PerfectFoward</span>(<span class="number">10</span>);			  <span class="comment">//rightv ref</span></span><br><span class="line">	<span class="type">int</span> a;</span><br><span class="line">	<span class="built_in">PerfectFoward</span>(a);			  <span class="comment">//leftv ref</span></span><br><span class="line">	<span class="built_in">PerfectFoward</span>(std::<span class="built_in">move</span>(a));  <span class="comment">//rightv ref</span></span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> b = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">PerfectFoward</span>(b);			  <span class="comment">//const leftv ref</span></span><br><span class="line">	<span class="built_in">PerfectFoward</span>(std::<span class="built_in">move</span>(b));  <span class="comment">//const rightv ref</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="五、lambda表达式"><a href="#五、lambda表达式" class="headerlink" title="五、lambda表达式"></a>五、lambda表达式</h1><hr>
<p>lambda表达式的轮廓为</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[capture - list] (parameters) <span class="keyword">mutable</span> -&gt; <span class="keyword">return</span>-type &#123;statement&#125;</span><br><span class="line">      捕捉列表		参数列表   取消常性      返回类型		函数体</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">add1</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//最简单的lambda表达式 : []&#123;&#125;</span></span><br><span class="line">	<span class="type">int</span> a = <span class="number">1</span>, b = <span class="number">2</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> add1 = [](<span class="type">int</span> x, <span class="type">int</span> y)-&gt;<span class="type">int</span> &#123;<span class="keyword">return</span> x + y; &#125;;</span><br><span class="line">	<span class="built_in">add1</span>(a, b);   <span class="comment">//调用的是lambda表达式(匿名函数)</span></span><br><span class="line">	::<span class="built_in">add1</span>(a, b); <span class="comment">//调用的是顶上的函数</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//auto add2 = [=]() &#123;return a + b; &#125;;  //=代表捕捉作用域内所有的值,同样的,&amp;捕捉作用域内所有数据的引用</span></span><br><span class="line">	<span class="keyword">auto</span> add2 = [a, b]() &#123;<span class="keyword">return</span> a + b; &#125;; <span class="comment">//捕捉到a,b , 返回类型其实会自动推导,可以不写</span></span><br><span class="line">	<span class="built_in">add2</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> add3 = [=]() &#123;<span class="keyword">return</span> <span class="built_in">add1</span>(a, b); &#125;; <span class="comment">//匿名函数调用匿名函数实现</span></span><br><span class="line">	<span class="keyword">auto</span> add4 = [=]() &#123;<span class="keyword">return</span> ::<span class="built_in">add1</span>(a, b); &#125;;<span class="comment">//匿名函数调用函数实现</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> swap1 = [&amp;]() &#123;<span class="type">int</span> x = a; a = b; b = x; &#125;;</span><br><span class="line">	<span class="built_in">swap1</span>();</span><br><span class="line">	cout &lt;&lt; a &lt;&lt; b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> swap2 = [&amp;a,&amp;b]() &#123;<span class="type">int</span> x = a; a = b; b = x; &#125;; <span class="comment">//捕捉的引用,而不是地址</span></span><br><span class="line">	<span class="built_in">swap2</span>();</span><br><span class="line">	cout &lt;&lt; a &lt;&lt; b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> swap3 = [](<span class="type">int</span>&amp; x,<span class="type">int</span>&amp; y) &#123;<span class="type">int</span> z = x; x = y; y = z; &#125;;</span><br><span class="line">	<span class="built_in">swap3</span>(a,b);</span><br><span class="line">	cout &lt;&lt; a &lt;&lt; b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//mutable</span></span><br><span class="line">	<span class="keyword">auto</span> test = [a, b]()<span class="keyword">mutable</span>&#123;<span class="type">int</span> c = a, a = <span class="number">20</span>, b = c; &#125;;</span><br><span class="line">	<span class="built_in">test</span>();</span><br><span class="line">	<span class="comment">//默认情况下,lambda函数总是const函数,mutable可以取消其常量性,使用该修饰符时,参数列表不可省略(即使参数为空)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//lambda表达式可以作为仿函数(其原理就是仿函数的operator()成员)(匿名函数)</span></span><br><span class="line">	<span class="type">int</span> arr[] = &#123;<span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">23</span>, <span class="number">5</span>, <span class="number">76</span>, <span class="number">5</span>, <span class="number">342</span>, <span class="number">4</span>&#125;;</span><br><span class="line">	<span class="built_in">sort</span>(arr, arr + <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(arr[<span class="number">0</span>]), [](<span class="keyword">auto</span> a, <span class="keyword">auto</span> b)&#123;<span class="keyword">return</span> a &gt; b; &#125;); <span class="comment">//默认升序,改为降序</span></span><br><span class="line">	<span class="built_in">sort</span>(arr, arr + <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(arr[<span class="number">0</span>]), std::<span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;()); <span class="comment">//默认升序,改为降序</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; e : arr)</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//底层还是依靠仿函数来实现</span></span><br><span class="line">	<span class="comment">//也就是定义lambda表达式,实际上是编译器会生成一个lambda_uuid类,仿函数的operator() 的参数和实现就是我们写的lambda</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="六、异常"><a href="#六、异常" class="headerlink" title="六、异常"></a>六、异常</h1><hr>
<h2 id="1-异常简介"><a href="#1-异常简介" class="headerlink" title="1.异常简介"></a>1.异常简介</h2><blockquote>
<p>传统处理错误的方式有:  1.返回错误码  2.终止程序:eg:exit()<br>其缺点是: 1.拿到错误码,需要查找错误码表才知道具体错误<br>       2.如果一个函数是通过返回值拿数据,发生错误很难处理(让传一个自定义类型,却传了个-1之类的)<br>        3.如果调用的函数栈很深,一层层返回错误码,处理很复杂</p>
</blockquote>
<blockquote>
<p>异常的优缺点:<br>优点:<br>1.清晰的包含错误信息<br>2.面对 T operator[](int i)这类函数越界错误,异常可以很好的解决<br>3.多层调用时,里面发生错误,不再需要层层处理,最外层直接捕获即可<br>4.很多第三方库都是用异常,使用异常可以更好的使用他们.eg:boost,gtest.gmock</p>
</blockquote>
<blockquote>
<p>缺点:<br>1.异常会导致执行流乱飞,会使得调试分析程序bug带来一些困难<br>2.异常可能导致资源泄露等异常安全问题,要学会RAII来解决<br>3.C++库里的异常体系不好用,常自己定义<br>4.C++异常语言可以抛任意类型异常,项目若没有规范管理,会非常混乱</p>
</blockquote>
<p>总的来说,异常利大于弊,实际小项目不使用</p>
<hr>
<h2 id="2-异常的基本使用"><a href="#2-异常的基本使用" class="headerlink" title="2.异常的基本使用"></a>2.异常的基本使用</h2><p>STL库中有的自带抛异常</p>
<blockquote>
<p>try和catch必须带有花括号,否则无法识别<br>如果try了没有catch到,程序会直接终止</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> <span class="comment">//STL中自带抛异常</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">try</span></span><br><span class="line">	&#123;</span><br><span class="line">		vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt;= v.<span class="built_in">size</span>(); ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//cout &lt;&lt; v[i] &lt;&lt; &quot; &quot;;</span></span><br><span class="line">			cout &lt;&lt; v.<span class="built_in">at</span>(i) &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">//自带的抛出异常</span></span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (exception&amp; e)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e.<span class="built_in">what</span>() &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">Div</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (n == <span class="number">0</span>) <span class="comment">//除零错误</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="built_in">string</span>(<span class="string">&quot;/0 error&quot;</span>); <span class="comment">//throw 可以抛出任意类型的对象</span></span><br><span class="line">		<span class="comment">//直接跳转到catch匹配的地方</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> m / n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Fun1</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//异常是可以截胡的,比如</span></span><br><span class="line">	<span class="keyword">try</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">Div</span>(m, n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (<span class="type">const</span> string&amp; err)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; __LINE__ &lt;&lt; err &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">		</span><br><span class="line">	<span class="comment">//return Div(m, n);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> m, n; cin &gt;&gt; m&gt;&gt; n;</span><br><span class="line">	<span class="keyword">try</span></span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">Fun1</span>(m, n) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (<span class="type">const</span> string&amp; err)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; __LINE__ &lt;&lt; err&lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (...) <span class="comment">//当throw的类型匹配不上以上的catch,就会都跳转到这里,避免异常没捕获时程序直接终止</span></span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;none matched catch&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>异常的底层逻辑</p>
<blockquote>
<p>首先检查throw本身是否在try内部,如果是再查找匹配的catch.<br>    没有则退出当前函数栈,继续在调用函数的栈中寻找匹配的catch<br>    如果main函数的栈中还没有,则终止程序</p>
</blockquote>
<hr>
<h2 id="3-异常的重新抛出-自定义异常类"><a href="#3-异常的重新抛出-自定义异常类" class="headerlink" title="3.异常的重新抛出,自定义异常类"></a>3.异常的重新抛出,自定义异常类</h2><p><code>异常是很危险的,非常容易导致内存泄漏</code></p>
<blockquote>
<p>,throw后直接跑到catch那里不再回来了,导致throw后可能有的释放内存没有进行</p>
</blockquote>
<p>解决的方法就是让异常重新抛出<br>一个实例</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Exception</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Exception</span>(<span class="type">const</span> <span class="type">char</span>* errmsg,<span class="type">int</span> errid)</span><br><span class="line">		:_errid(errid)</span><br><span class="line">		,_errmsg(errmsg)</span><br><span class="line">	&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> string <span class="title">what</span><span class="params">()</span> </span>= <span class="number">0</span>; <span class="comment">//纯虚函数,构成多态</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="type">int</span> _errid; <span class="comment">//错误码</span></span><br><span class="line">	string _errmsg; <span class="comment">//错误信息</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SqlException</span> : <span class="keyword">public</span> Exception</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">SqlException</span>(<span class="type">const</span> <span class="type">char</span>* errmsg, <span class="type">int</span> errid)</span><br><span class="line">		:<span class="built_in">Exception</span>(errmsg, errid)</span><br><span class="line">	&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> string <span class="title">what</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;sql error : &quot;</span> + _errmsg;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NetworkException</span> : <span class="keyword">public</span> Exception</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">NetworkException</span>(<span class="type">const</span> <span class="type">char</span>* errmsg, <span class="type">int</span> errid)</span><br><span class="line">		:<span class="built_in">Exception</span>(errmsg,errid)</span><br><span class="line">	&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> string <span class="title">what</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;internet error : &quot;</span> + _errmsg;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ServeStart</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//if (rand() % 6 == 0)</span></span><br><span class="line">	<span class="comment">//	throw SqlException(&quot;sql open error&quot;, 1);</span></span><br><span class="line">	<span class="comment">//if (rand() % 7 == 0)</span></span><br><span class="line">	<span class="comment">//	throw NetworkException(&quot;internet connect error&quot;, 3);</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; &quot;sucessful&quot; &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//模拟一下出现问题抛异常报错</span></span><br><span class="line">	<span class="type">int</span>* arr = <span class="keyword">new</span> <span class="type">int</span>[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">rand</span>() % <span class="number">6</span> == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">throw</span> <span class="built_in">SqlException</span>(<span class="string">&quot;sql open error&quot;</span>, <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">rand</span>() % <span class="number">7</span> == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">throw</span> <span class="built_in">NetworkException</span>(<span class="string">&quot;internet connect error&quot;</span>, <span class="number">3</span>);</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;sucessful&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (<span class="type">const</span> Exception&amp; err) <span class="comment">//如果抛出异常</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">delete</span>[] arr;  </span><br><span class="line">		<span class="keyword">throw</span>; <span class="comment">//重新抛出异常,以正确输出所需内容</span></span><br><span class="line">			   <span class="comment">//截胡处理一下,再把路让出来过去</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">delete</span>[] arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> <span class="comment">//自定义异常类(继承体系)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">try</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">ServeStart</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">catch</span> (Exception&amp; err)</span><br><span class="line">		&#123;</span><br><span class="line">			cout &lt;&lt; err.<span class="built_in">what</span>() &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">catch</span> (...)</span><br><span class="line">		&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;catch error&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-异常规范"><a href="#4-异常规范" class="headerlink" title="4.异常规范"></a>4.异常规范</h2><blockquote>
<p> throw(A,B)<br>  函数会抛出A,B类型某个类的异常<br> throw(A)<br> 函数只会抛出A类型异常<br>throw()<br>函数不会抛出异常<br> noexcept<br> 函数不会抛出异常</p>
</blockquote>
<blockquote>
<p>void* operator new(std::size_t size) throw(std::bad_alloc);  &#x2F;&#x2F;表示这个函数只会抛出bad_alloc异常<br>void* operator delete(std::size_t size, void* ptr) throw();  &#x2F;&#x2F;表示这个函数不会抛出异常<br>void* operator delete(std::size_t size, void* ptr) noexcept; &#x2F;&#x2F;表示这个函数不会抛出异常</p>
</blockquote>
<hr>
<h1 id="七、类型转换"><a href="#七、类型转换" class="headerlink" title="七、类型转换"></a>七、类型转换</h1><hr>
<h2 id="1-隐式类型转换和显示类型转换"><a href="#1-隐式类型转换和显示类型转换" class="headerlink" title="1.隐式类型转换和显示类型转换"></a>1.隐式类型转换和显示类型转换</h2><blockquote>
<p>隐式类型转换:相近类型,也就是意义相似的类别之间的转换<br>显示类型转换:不相近类型,意义差别很大的类型的转换</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="type">double</span> d = <span class="number">3.33</span>;</span><br><span class="line">i = d;           <span class="comment">//C语言支持相近类型的隐式类型转换(相近类型,也就是意义相似的类别)</span></span><br><span class="line">cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* p = <span class="literal">nullptr</span>;</span><br><span class="line">p = (<span class="type">int</span>*)i;     <span class="comment">//C语言支持不相近类型强制类型转换(不相近类型,意义差别很大的类型)</span></span><br><span class="line">cout &lt;&lt; p &lt;&lt; endl;</span><br></pre></td></tr></table></figure>

<h2 id="2-C-11中的类型转换操作符"><a href="#2-C-11中的类型转换操作符" class="headerlink" title="2.C++11中的类型转换操作符"></a>2.C++11中的类型转换操作符</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static_cast</span> 		<span class="comment">//隐式类型转换</span></span><br><span class="line"><span class="keyword">reinterpret_cast</span>    <span class="comment">//强制类型转换</span></span><br><span class="line"><span class="keyword">const_cast</span> 			<span class="comment">//强制类型转换,并去掉const属性</span></span><br><span class="line"><span class="keyword">dynamic_cast</span> 		<span class="comment">//父子类转换</span></span><br></pre></td></tr></table></figure>

<h3 id="①static-cast-reinterpret-cast"><a href="#①static-cast-reinterpret-cast" class="headerlink" title="①static_cast,reinterpret_cast"></a>①static_cast,reinterpret_cast</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line">	<span class="type">double</span> d = <span class="number">3.33</span>;</span><br><span class="line">	<span class="type">int</span>* p = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	d = <span class="built_in">static_cast</span>&lt;<span class="type">double</span>&gt;(i);		  <span class="comment">//对应C的隐式类型转换(相近类型)</span></span><br><span class="line">	p = <span class="built_in">reinterpret_cast</span>&lt;<span class="type">int</span>*&gt;(i);    <span class="comment">//对应C的强制类型转换(不相近类型)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果用错操作符是没办法编译通过的</span></span><br><span class="line">	<span class="comment">//d = reinterpret_cast&lt;double&gt;(i);</span></span><br><span class="line">	<span class="comment">//p = static_cast&lt;int*&gt;(i);		</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="②const-cast"><a href="#②const-cast" class="headerlink" title="②const_cast"></a>②const_cast</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//const int ci = 10;</span></span><br><span class="line">	<span class="keyword">volatile</span> <span class="type">const</span> <span class="type">int</span> ci = <span class="number">10</span>;</span><br><span class="line">	<span class="type">int</span>* pi = <span class="built_in">const_cast</span>&lt;<span class="type">int</span>*&gt;(&amp;ci); <span class="comment">//强制类型转换,并去掉const属性</span></span><br><span class="line">	*pi = <span class="number">20</span>;</span><br><span class="line">	cout &lt;&lt; *pi &lt;&lt; endl; <span class="comment">//20</span></span><br><span class="line">	cout &lt;&lt; ci &lt;&lt; endl;  <span class="comment">//10</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//为什么监视窗口中(内存中)得到的ci是20,但是输出却是10呢?</span></span><br><span class="line">	<span class="comment">//ci的内存中存储的值确实被改成了20,但是ci放进了寄存器,这里去寄存器中取,还是10</span></span><br><span class="line">	<span class="comment">//本质上是编译器对const对象存取优化机制导致</span></span><br><span class="line">	<span class="comment">//可以加入volatile关键字去内存中取值,可以禁止编译器的优化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="③dynamic-cast"><a href="#③dynamic-cast" class="headerlink" title="③dynamic_cast"></a>③dynamic_cast</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">Fun</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;&#125;</span><br><span class="line">	<span class="type">int</span> _a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="type">int</span> _b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Fun_cast</span><span class="params">(A* pa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//如果想区分pa是指向父类还是子类</span></span><br><span class="line">	<span class="comment">//pa指向子类对象则转换成功</span></span><br><span class="line">	<span class="comment">//pa指向父类对象就转换失败,返回nullptr</span></span><br><span class="line">	B* pb = <span class="built_in">dynamic_cast</span>&lt;B*&gt;(pa);</span><br><span class="line">	<span class="comment">//B* pb = (B*)pa;   //只会根据情况成功或 失败(程序崩溃)</span></span><br><span class="line">	<span class="keyword">if</span> (pb != <span class="literal">nullptr</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;translated pa-&gt;parent&quot;</span> &lt;&lt; endl;</span><br><span class="line">		pb-&gt;_a = <span class="number">10</span>;</span><br><span class="line">		pb-&gt;_b = <span class="number">20</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;translat error&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	A a;</span><br><span class="line">	B b;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//子类对象可以赋值给父类的对象、指针、引用,这个过程叫做切片,这是天然支持的,称为 向上转换</span></span><br><span class="line">	<span class="comment">//父类的对象、指针、引用传给子类的指针...,这个过程叫做向下转换,根据实际情况有可能成功</span></span><br><span class="line"></span><br><span class="line">	A* pa = &amp;a;</span><br><span class="line">	<span class="built_in">Fun_cast</span>(pa);  <span class="comment">//pa指向父类</span></span><br><span class="line"></span><br><span class="line">	pa = &amp;b;</span><br><span class="line">	<span class="built_in">Fun_cast</span>(pa);  <span class="comment">//pa指向子类</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//dynamic_cast向下转换只能针对继承中多态类型(父类必须含有虚函数)</span></span><br><span class="line">	<span class="comment">//这就涉及到 dynamic_cast 的原理: 其如何实现识别父类子类的呢?</span></span><br><span class="line">	<span class="comment">//dynamic_cast通过去虚表上方存储的标识信息,来判断指向的是父类还是子类</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="④explicit"><a href="#④explicit" class="headerlink" title="④explicit"></a>④explicit</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AA</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">explicit</span> <span class="title">AA</span><span class="params">(<span class="type">int</span> a)</span>  <span class="comment">//加入explicit可以阻止隐式转换地构造</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;AA(int a)&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">AA</span>(<span class="type">const</span> AA&amp; a)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;AA(const AA&amp; a)&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> _a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test5</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">AA <span class="title">a1</span><span class="params">(<span class="number">1</span>)</span></span>;  <span class="comment">//构造</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//隐式转换 : AA tmp(1) -&gt; AA a2(tmp)  先构造再拷贝构造被优化为只有构造,优化取决于编译器</span></span><br><span class="line">	<span class="comment">//以防有些没有优化的编译器导致的低效,加入explicit可以阻止这种隐式转换</span></span><br><span class="line">	<span class="comment">//AA a2 = 1; </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="八、IO流"><a href="#八、IO流" class="headerlink" title="八、IO流"></a>八、IO流</h1><hr>
<h2 id="1-IO流-简单的使用"><a href="#1-IO流-简单的使用" class="headerlink" title="1.IO流 简单的使用"></a>1.IO流 简单的使用</h2><table>
<thead>
<tr>
<th>文件打开方式</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>ios::in</td>
<td>为读文件打开文件</td>
</tr>
<tr>
<td>ios::out</td>
<td>为写文件打开文件</td>
</tr>
<tr>
<td>ios::ate</td>
<td>初始位置:文件尾</td>
</tr>
<tr>
<td>ios::app</td>
<td>追加方式写文件</td>
</tr>
<tr>
<td>ios::trunc</td>
<td>如果文件存在先删除,再创建</td>
</tr>
<tr>
<td>ios::binary</td>
<td>二进制方法</td>
</tr>
</tbody></table>
<blockquote>
<p>ofstream 写操作<br>ifstream 读操作<br>fstream 读写操作</p>
</blockquote>
<p>文本文件写文件</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ofstream ofs; 			<span class="comment">//其实前两行可以合并为 ofstream ofs(&quot;文件.txt&quot;,ios::out);</span></span><br><span class="line">	ofs.<span class="built_in">open</span>(<span class="string">&quot;文件.txt&quot;</span>,ios::out);</span><br><span class="line">	ofs&lt;&lt;<span class="string">&quot;内容&quot;</span>&lt;&lt;endl;</span><br><span class="line">	ofs.<span class="built_in">close</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>文本文件读文件</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">ifstream <span class="title">ifs</span><span class="params">(<span class="string">&quot;文件.txt&quot;</span>,ios::in)</span></span>;</span><br><span class="line">	<span class="keyword">if</span>(!ifs.<span class="built_in">is_open</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;文件打开失败&quot;</span>&lt;&lt;endl;</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//读数据 多种方法</span></span><br><span class="line">	<span class="comment">//1</span></span><br><span class="line">	<span class="type">char</span> buf[<span class="number">1024</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">while</span>(ifs&gt;&gt;buf)</span><br><span class="line">		cout&lt;&lt;buf&lt;&lt;endl;</span><br><span class="line">	<span class="comment">//2</span></span><br><span class="line">	<span class="type">char</span> buf[<span class="number">1024</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">while</span>(ifs.<span class="built_in">getline</span>(buf,<span class="built_in">sizeof</span>(buf)))</span><br><span class="line">		cout&lt;&lt;buf&lt;&lt;endl;</span><br><span class="line">	<span class="comment">//3</span></span><br><span class="line">	string buf;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">getline</span>(ifs,buf))</span><br><span class="line">		cout&lt;&lt;buf&lt;&lt;endl;</span><br><span class="line">	<span class="comment">//4</span></span><br><span class="line">	<span class="type">char</span> c;</span><br><span class="line">	<span class="keyword">while</span>((c=ifs.<span class="built_in">get</span>()) != EOF)</span><br><span class="line">		cout&lt;&lt;c;</span><br><span class="line">	ifs.<span class="built_in">close</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>二进制写文件</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">	<span class="type">char</span> name[<span class="number">64</span>];</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ofstream ofs; <span class="comment">//ofstream ofs(&quot;文件.txt&quot;,ios::out | ios::binary);</span></span><br><span class="line">	ofs.<span class="built_in">open</span>(<span class="string">&quot;文件.txt&quot;</span>,ios::out | ios::binary); <span class="comment">//二进制方法写文件</span></span><br><span class="line">	</span><br><span class="line">	Person p = &#123;<span class="string">&quot;name&quot;</span>,<span class="number">18</span>&#125;;</span><br><span class="line">	ofs.<span class="built_in">write</span>((<span class="type">const</span> <span class="type">char</span>*)&amp;p,<span class="built_in">sizeof</span>(Person));</span><br><span class="line">	ofs.<span class="built_in">close</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>二进制读文件</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">	<span class="type">char</span> name[<span class="number">64</span>];</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">ifstream <span class="title">ifs</span><span class="params">(<span class="string">&quot;文件.txt&quot;</span>,ios::in | ios::binary)</span></span>;</span><br><span class="line">	<span class="keyword">if</span>(!ifs.<span class="built_in">is_open</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;文件打开失败&quot;</span>&lt;&lt;endl;</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	Person p;</span><br><span class="line">	ifs.<span class="built_in">read</span>((<span class="type">char</span>*) &amp;p,<span class="built_in">sizeof</span>(Person));</span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;name:&quot;</span>&lt;&lt;p.name&lt;&lt;<span class="string">&quot;age&quot;</span> &lt;&lt; p.age&lt;&lt;endl;</span><br><span class="line">	ifs.<span class="built_in">close</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="其他写法读写文件"><a href="#其他写法读写文件" class="headerlink" title="其他写法读写文件"></a>其他写法读写文件<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">ofstream <span class="title">ofs</span><span class="params">(<span class="string">&quot;text.txt&quot;</span>)</span></span>;			<span class="comment">//fopen( ,&quot;W&quot;);</span></span><br><span class="line">	ofs.<span class="built_in">put</span>(<span class="string">&#x27;x&#x27;</span>);						<span class="comment">//fputc</span></span><br><span class="line">	ofs.<span class="built_in">write</span>(<span class="string">&quot;jack&quot;</span>, <span class="number">5</span>);				<span class="comment">//fwrite</span></span><br><span class="line">	ofs.<span class="built_in">close</span>();						<span class="comment">//fclose</span></span><br><span class="line"></span><br><span class="line">	<span class="function">ifstream <span class="title">ifs</span><span class="params">(<span class="string">&quot;text.txt&quot;</span>)</span></span>;			<span class="comment">//fopen( , &quot;R&quot;);</span></span><br><span class="line">	<span class="comment">//cout &lt;&lt; (char)ifs.get() &lt;&lt; endl;  //fgetc</span></span><br><span class="line">	cout&lt;&lt;ifs.<span class="built_in">rdbuf</span>();					<span class="comment">//输出文件缓冲区外所有内容,如果前面已经输出了,就不再输出了</span></span><br><span class="line">	<span class="comment">//ifs.read							//fread</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></h2><h2 id="2-读写结构体"><a href="#2-读写结构体" class="headerlink" title="2.读写结构体"></a>2.读写结构体</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Msg</span></span><br><span class="line">&#123;</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//使用起来和cin cout类似</span></span><br><span class="line">	Msg per1&#123; <span class="string">&quot;jack&quot;</span>,<span class="number">18</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function">ofstream <span class="title">ofs</span><span class="params">(<span class="string">&quot;text.txt&quot;</span>)</span></span>;</span><br><span class="line">	ofs &lt;&lt; per1.name &lt;&lt; endl; <span class="comment">//要给上换行或者空格,否则在读文件时会无法分割</span></span><br><span class="line">	ofs &lt;&lt; per1.age &lt;&lt; endl;</span><br><span class="line">	ofs.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line">	Msg per2;</span><br><span class="line">	<span class="function">ifstream <span class="title">ifs</span><span class="params">(<span class="string">&quot;text.txt&quot;</span>)</span></span>;</span><br><span class="line">	<span class="comment">//ifs &gt;&gt; per2.name;</span></span><br><span class="line">	<span class="comment">//ifs &gt;&gt; per2.age;</span></span><br><span class="line">	cout &lt;&lt; ifs.<span class="built_in">rdbuf</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="3-序列化"><a href="#3-序列化" class="headerlink" title="3.序列化"></a>3.序列化</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Msg</span></span><br><span class="line">&#123;</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Msg per1&#123; <span class="string">&quot;jack&quot;</span>,<span class="number">18</span> &#125;;</span><br><span class="line">	<span class="comment">//序列化字符串</span></span><br><span class="line">	ostringstream ost;</span><br><span class="line">	ost &lt;&lt; per1.name &lt;&lt; endl;</span><br><span class="line">	ost &lt;&lt; per1.age &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	string str1 = ost.<span class="built_in">str</span>();</span><br><span class="line">	cout &lt;&lt; str1 &lt;&lt; endl;  <span class="comment">//网络中可以把这个str1发送给另一端</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//网络另一端接收后就可以开始解析数据</span></span><br><span class="line">	<span class="comment">//反序列化</span></span><br><span class="line">	istringstream ist;</span><br><span class="line">	Msg per2;</span><br><span class="line">	ist &gt;&gt; per2.name;</span><br><span class="line">	ist &gt;&gt; per2.age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%96%87%E4%BB%B6IO/">文件IO</a><a class="post-meta__tags" href="/tags/C-%E7%89%B9%E6%80%A7/">C++特性</a></div><div class="post_share"><div class="social-share" data-image="/pic/2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/21/cpp11-2/" title="C++11"><img class="cover" src="/pic/2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">C++11</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/21/cpp-%E4%BD%8D%E5%9B%BE-%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/" title="位图,布隆过滤器"><img class="cover" src="/pic/2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">位图,布隆过滤器</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/10/21/c-%E6%96%87%E4%BB%B6/" title="文件"><img class="cover" src="/pic/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">文件</div></div></a></div><div><a href="/2023/10/22/%E6%96%87%E4%BB%B6IO/" title="文件IO"><img class="cover" src="/pic/3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-22</div><div class="title">文件IO</div></div></a></div><div><a href="/2023/10/21/cpp-%E5%A4%9A%E6%80%81/" title="多态"><img class="cover" src="/pic/2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">多态</div></div></a></div><div><a href="/2023/10/21/cpp-%E7%BB%A7%E6%89%BF/" title="继承"><img class="cover" src="/pic/2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">继承</div></div></a></div><div><a href="/2023/10/21/cpp11-2/" title="C++11"><img class="cover" src="/pic/2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">C++11</div></div></a></div><div><a href="/2023/10/22/%E6%A8%A1%E6%9D%BF/" title="模板"><img class="cover" src="/pic/2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-22</div><div class="title">模板</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/pic/avater.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">9TSe</div><div class="author-info__description">难正经</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">43</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/9tse"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/9TSe" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:9TSewer@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">C++部分,Qt,Linux,文章摘于 https://subingwen.cn/</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81decltype-RTTI"><span class="toc-text">一、decltype(RTTI)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81C-11%E4%B8%AD%E7%9A%84%E6%96%B0%E5%AE%B9%E5%99%A8"><span class="toc-text">二、C++11中的新容器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E9%BB%98%E8%AE%A4%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E7%9A%84%E6%8E%A7%E5%88%B6"><span class="toc-text">三、默认成员函数的控制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8"><span class="toc-text">四、右值引用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">1.右值引用的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">2.右值引用的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-emplace-back"><span class="toc-text">3.emplace_back</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AE%8C%E7%BE%8E%E8%BD%AC%E5%8F%91"><span class="toc-text">4.完美转发</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">五、lambda表达式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%BC%82%E5%B8%B8"><span class="toc-text">六、异常</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%BC%82%E5%B8%B8%E7%AE%80%E4%BB%8B"><span class="toc-text">1.异常简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%BC%82%E5%B8%B8%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">2.异常的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%BC%82%E5%B8%B8%E7%9A%84%E9%87%8D%E6%96%B0%E6%8A%9B%E5%87%BA-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E7%B1%BB"><span class="toc-text">3.异常的重新抛出,自定义异常类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%BC%82%E5%B8%B8%E8%A7%84%E8%8C%83"><span class="toc-text">4.异常规范</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-text">七、类型转换</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%9A%90%E5%BC%8F%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%92%8C%E6%98%BE%E7%A4%BA%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-text">1.隐式类型转换和显示类型转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-C-11%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-text">2.C++11中的类型转换操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%91%A0static-cast-reinterpret-cast"><span class="toc-text">①static_cast,reinterpret_cast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%91%A1const-cast"><span class="toc-text">②const_cast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%91%A2dynamic-cast"><span class="toc-text">③dynamic_cast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%91%A3explicit"><span class="toc-text">④explicit</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81IO%E6%B5%81"><span class="toc-text">八、IO流</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-IO%E6%B5%81-%E7%AE%80%E5%8D%95%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">1.IO流 简单的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%86%99%E6%B3%95%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-text">其他写法读写文件12345678910111213#include&lt;fstream&gt;int main(){	ofstream ofs(&quot;text.txt&quot;);			&#x2F;&#x2F;fopen( ,&quot;W&quot;);	ofs.put(&#39;x&#39;);						&#x2F;&#x2F;fputc	ofs.write(&quot;jack&quot;, 5);				&#x2F;&#x2F;fwrite	ofs.close();						&#x2F;&#x2F;fclose	ifstream ifs(&quot;text.txt&quot;);			&#x2F;&#x2F;fopen( , &quot;R&quot;);	&#x2F;&#x2F;cout &lt;&lt; (char)ifs.get() &lt;&lt; endl;  &#x2F;&#x2F;fgetc	cout&lt;&lt;ifs.rdbuf();					&#x2F;&#x2F;输出文件缓冲区外所有内容,如果前面已经输出了,就不再输出了	&#x2F;&#x2F;ifs.read							&#x2F;&#x2F;fread}</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%AF%BB%E5%86%99%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-text">2.读写结构体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">3.序列化</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/03/MysqlAPI/" title="MySQL 在C/C++中的API"><img src="/pic/8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL 在C/C++中的API"/></a><div class="content"><a class="title" href="/2023/11/03/MysqlAPI/" title="MySQL 在C/C++中的API">MySQL 在C/C++中的API</a><time datetime="2023-11-03T02:12:53.000Z" title="发表于 2023-11-03 10:12:53">2023-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/03/stu-msg-manage-system/" title="学生管理系统"><img src="/pic/3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="学生管理系统"/></a><div class="content"><a class="title" href="/2023/11/03/stu-msg-manage-system/" title="学生管理系统">学生管理系统</a><time datetime="2023-11-03T02:12:41.000Z" title="发表于 2023-11-03 10:12:41">2023-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/29/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="设计模式基础和创建型模型"><img src="/pic/2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="设计模式基础和创建型模型"/></a><div class="content"><a class="title" href="/2023/10/29/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="设计模式基础和创建型模型">设计模式基础和创建型模型</a><time datetime="2023-10-29T09:41:47.000Z" title="发表于 2023-10-29 17:41:47">2023-10-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/27/Git/" title="Git"><img src="/pic/3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git"/></a><div class="content"><a class="title" href="/2023/10/27/Git/" title="Git">Git</a><time datetime="2023-10-27T10:46:57.000Z" title="发表于 2023-10-27 18:46:57">2023-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/26/%E6%B1%87%E7%BC%96/" title="汇编"><img src="/pic/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="汇编"/></a><div class="content"><a class="title" href="/2023/10/26/%E6%B1%87%E7%BC%96/" title="汇编">汇编</a><time datetime="2023-10-26T11:45:36.000Z" title="发表于 2023-10-26 19:45:36">2023-10-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 9TSe</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>